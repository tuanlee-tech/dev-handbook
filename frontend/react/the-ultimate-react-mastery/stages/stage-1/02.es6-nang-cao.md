# üìÖ NG√ÄY 2: ES6+ N√ÇNG CAO - C√îNG C·ª§ QUY·ªÄN NƒÇNG CHO REACT

## üìç Phase 1, Week 1, Day 2 of 75

## ‚è±Ô∏è Th·ªùi l∆∞·ª£ng: 3-4 gi·ªù (bao g·ªìm breaks)

## üéØ M·ª•c ti√™u h·ªçc t·∫≠p (5 ph√∫t)

Sau b√†i h·ªçc h√¥m nay, b·∫°n s·∫Ω:

- [ ] **Hi·ªÉu v√† v·∫≠n d·ª•ng th√†nh th·∫°o** Promises v√† async/await (concepts - ch∆∞a d√πng th·ª±c t·∫ø)
- [ ] **L√†m ch·ªß ES6 Modules** - import/export patterns cho React projects
- [ ] **S·ª≠ d·ª•ng th√†nh th·∫°o** Optional chaining (?.) v√† Nullish coalescing (??)
- [ ] **N·∫Øm v·ªØng** c√°c Array/Object methods n√¢ng cao (find, some, every, entries, keys, values)

## ü§î Ki·ªÉm tra ƒë·∫ßu v√†o (5 ph√∫t)

Tr∆∞·ªõc khi b·∫Øt ƒë·∫ßu, h√£y t·ª± h·ªèi m√¨nh:

1. **Destructuring:** `const { name, age } = user` - B·∫°n c√≥ hi·ªÉu c√°ch n√†y ho·∫°t ƒë·ªông kh√¥ng?
2. **Spread operator:** `const newArr = [...oldArr, newItem]` - T·∫°i sao c·∫ßn d·∫•u `...`?
3. **Arrow functions:** `const double = x => x * 2` - Kh√°c g√¨ v·ªõi `function double(x) { return x * 2 }`?

> üí° N·∫øu ch∆∞a v·ªØng, h√£y xem l·∫°i Ng√†y 1 tr∆∞·ªõc khi ti·∫øp t·ª•c!

---

## üìñ PH·∫¶N 1: GI·ªöI THI·ªÜU KH√ÅI NI·ªÜM (30 ph√∫t)

### 1.1 V·∫•n ƒê·ªÅ Th·ª±c T·∫ø

Khi x√¢y d·ª±ng ·ª©ng d·ª•ng React, b·∫°n s·∫Ω th∆∞·ªùng xuy√™n g·∫∑p nh·ªØng t√¨nh hu·ªëng n√†y:

**Scenario 1: Code "callback hell"**

```javascript
// ‚ùå Code kh√≥ ƒë·ªçc, kh√≥ maintain
fetchUser(userId, function (user) {
  fetchPosts(user.id, function (posts) {
    fetchComments(posts[0].id, function (comments) {
      console.log(comments);
      // üò± "Pyramid of Doom"
    });
  });
});
```

**Scenario 2: Import/Export l·ªôn x·ªôn**

```javascript
// ‚ùå Kh√¥ng bi·∫øt import t·ª´ ƒë√¢u
import Something from "./utils";
import AnotherThing from "./helpers";
import YetAnother from "./tools";
// ü§î File n√†o c√≥ g√¨?
```

**Scenario 3: Null/Undefined checks r·ªëi r·∫Øm**

```javascript
// ‚ùå Code d√†i d√≤ng, d·ªÖ sai
if (user && user.profile && user.profile.address && user.profile.address.city) {
  console.log(user.profile.address.city);
}
```

### 1.2 Gi·∫£i Ph√°p

ES6+ cung c·∫•p c√°c c√¥ng c·ª• m·∫°nh m·∫Ω ƒë·ªÉ gi·∫£i quy·∫øt c√°c v·∫•n ƒë·ªÅ tr√™n:

‚úÖ **Promises & async/await** - Code b·∫•t ƒë·ªìng b·ªô d·ªÖ ƒë·ªçc nh∆∞ code ƒë·ªìng b·ªô  
‚úÖ **ES6 Modules** - T·ªï ch·ª©c code r√µ r√†ng, t√°i s·ª≠ d·ª•ng cao  
‚úÖ **Optional chaining (?.)** - Truy c·∫≠p nested properties an to√†n  
‚úÖ **Nullish coalescing (??)** - Default values th√¥ng minh h∆°n

### 1.3 Mental Model

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ     ES6+ MODERN JAVASCRIPT TOOLS        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                         ‚îÇ
‚îÇ  Async Programming                      ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê           ‚îÇ
‚îÇ  ‚îÇ Callback ‚Üí Promise ‚Üí     ‚îÇ           ‚îÇ
‚îÇ  ‚îÇ async/await              ‚îÇ           ‚îÇ
‚îÇ  ‚îÇ (t·ª´ kh√≥ ‚Üí d·ªÖ ƒë·ªçc)        ‚îÇ           ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò           ‚îÇ
‚îÇ                                         ‚îÇ
‚îÇ  Code Organization                      ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê           ‚îÇ
‚îÇ  ‚îÇ import/export ‚Üí          ‚îÇ           ‚îÇ
‚îÇ  ‚îÇ Module system            ‚îÇ           ‚îÇ
‚îÇ  ‚îÇ (code g·ªçn g√†ng)          ‚îÇ           ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò           ‚îÇ
‚îÇ                                         ‚îÇ
‚îÇ  Safe Access                            ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê           ‚îÇ
‚îÇ  ‚îÇ ?. (optional chain)      ‚îÇ           ‚îÇ
‚îÇ  ‚îÇ ?? (nullish coalesce)    ‚îÇ           ‚îÇ
‚îÇ  ‚îÇ (tr√°nh runtime errors)   ‚îÇ           ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò           ‚îÇ
‚îÇ                                         ‚îÇ
‚îÇ  Data Processing                        ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê           ‚îÇ
‚îÇ  ‚îÇ find, some, every...     ‚îÇ           ‚îÇ
‚îÇ  ‚îÇ (x·ª≠ l√Ω data hi·ªáu qu·∫£)    ‚îÇ           ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Analogy d·ªÖ hi·ªÉu:**

> üç≥ **N·∫•u ƒÉn theo recipe:**
>
> - **Callback** = G·ªçi ƒëi·ªán h·ªèi t·ª´ng b∆∞·ªõc (ch·∫≠m, d·ªÖ qu√™n)
> - **Promise** = C√≥ recipe vi·∫øt s·∫µn (r√µ r√†ng h∆°n)
> - **Async/await** = C√≥ ng∆∞·ªùi h∆∞·ªõng d·∫´n t·ª´ng b∆∞·ªõc (d·ªÖ nh·∫•t!)

### 1.4 Hi·ªÉu L·∫ßm Ph·ªï Bi·∫øn

‚ùå **SAI #1:** "async/await l√† c√°ch vi·∫øt kh√°c c·ªßa Promise"

‚úÖ **ƒê√öNG:** async/await l√† syntax sugar gi√∫p VI·∫æT code v·ªõi Promise d·ªÖ h∆°n

‚ùå **SAI #2:** "Optional chaining (?.) v√† OR (||) gi·ªëng nhau"

‚úÖ **ƒê√öNG:** `?.` check null/undefined, `||` check falsy (bao g·ªìm 0, '', false)

‚ùå **SAI #3:** "Import default v√† named import d√πng th·∫ø n√†o c≈©ng ƒë∆∞·ª£c"

‚úÖ **ƒê√öNG:** C√≥ quy ∆∞·ªõc r√µ r√†ng - default cho main export, named cho utilities

---

## üíª PH·∫¶N 2: LIVE CODING (45 ph√∫t)

### Demo 1: Promises & async/await Basics ‚≠ê

#### A. Hi·ªÉu Promise t·ª´ ƒë·∫ßu

```javascript
// ========================================
// DEMO: T·∫°o v√† s·ª≠ d·ª•ng Promise
// ========================================

// ‚ùå C√ÅC SAI: Callback Hell
console.log("=== ‚ùå Callback Pattern (Kh√≥ ƒë·ªçc) ===");

function fetchUserCallback(userId, callback) {
  setTimeout(() => {
    const user = { id: userId, name: "John Doe" };
    callback(user);
  }, 1000);
}

function fetchPostsCallback(userId, callback) {
  setTimeout(() => {
    const posts = [
      { id: 1, title: "Post 1", userId },
      { id: 2, title: "Post 2", userId },
    ];
    callback(posts);
  }, 1000);
}

// S·ª≠ d·ª•ng - KH·ª¶NG KHI·∫æP!
fetchUserCallback(1, (user) => {
  console.log("User:", user);
  fetchPostsCallback(user.id, (posts) => {
    console.log("Posts:", posts);
    // N·∫øu c·∫ßn fetch th√™m ‚Üí c√†ng l·ªìng s√¢u h∆°n üò±
  });
});

// ‚úÖ C√ÅCH ƒê√öNG: Promise Pattern
console.log("\n=== ‚úÖ Promise Pattern (D·ªÖ ƒë·ªçc h∆°n) ===");

function fetchUserPromise(userId) {
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      const user = { id: userId, name: "John Doe" };
      resolve(user); // Th√†nh c√¥ng
      // reject(new Error('User not found')); // Th·∫•t b·∫°i
    }, 1000);
  });
}

function fetchPostsPromise(userId) {
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      const posts = [
        { id: 1, title: "Post 1", userId },
        { id: 2, title: "Post 2", userId },
      ];
      resolve(posts);
    }, 1000);
  });
}

// S·ª≠ d·ª•ng - G·ªåN G√ÄNG H∆†N!
fetchUserPromise(1)
  .then((user) => {
    console.log("User:", user);
    return fetchPostsPromise(user.id); // Chaining
  })
  .then((posts) => {
    console.log("Posts:", posts);
  })
  .catch((error) => {
    console.error("Error:", error);
  });

// üéØ C√ÅCH T·ªêT NH·∫§T: async/await
console.log("\n=== üéØ async/await Pattern (D·ªÑ NH·∫§T!) ===");

async function getUserAndPosts(userId) {
  try {
    const user = await fetchUserPromise(userId);
    console.log("User:", user);

    const posts = await fetchPostsPromise(user.id);
    console.log("Posts:", posts);

    return { user, posts };
  } catch (error) {
    console.error("Error:", error);
  }
}

// S·ª≠ d·ª•ng
getUserAndPosts(1);
```

**üìä So s√°nh 3 patterns:**

| Pattern     | Readability | Error Handling | Debugging  |
| ----------- | ----------- | -------------- | ---------- |
| Callbacks   | ‚≠ê          | ‚≠ê             | ‚≠ê         |
| Promises    | ‚≠ê‚≠ê‚≠ê      | ‚≠ê‚≠ê‚≠ê         | ‚≠ê‚≠ê‚≠ê     |
| async/await | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê  | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê     | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |

#### B. async/await Best Practices

```javascript
// ========================================
// DEMO: async/await Patterns
// ========================================

// ‚úÖ PATTERN 1: Try-catch cho error handling
async function fetchData() {
  try {
    const response = await fetch("https://api.example.com/data");
    const data = await response.json();
    return data;
  } catch (error) {
    console.error("Fetch failed:", error);
    throw error; // Re-throw n·∫øu c·∫ßn handle ·ªü level cao h∆°n
  }
}

// ‚úÖ PATTERN 2: Multiple await (sequential)
async function sequentialFetch() {
  console.log("Fetching sequentially...");
  const user = await fetchUserPromise(1); // Ch·ªù 1s
  const posts = await fetchPostsPromise(user.id); // Ch·ªù th√™m 1s
  // T·ªïng: 2s
  return { user, posts };
}

// ‚úÖ PATTERN 3: Promise.all (parallel)
async function parallelFetch() {
  console.log("Fetching in parallel...");
  const [user, posts] = await Promise.all([
    fetchUserPromise(1),
    fetchPostsPromise(1),
  ]);
  // T·ªïng: 1s (ch·∫°y ƒë·ªìng th·ªùi!)
  return { user, posts };
}

// ‚ùå ANTI-PATTERN: Qu√™n await
async function forgotAwait() {
  const data = fetchUserPromise(1); // ‚ùå Qu√™n await
  console.log(data); // Promise {<pending>} - KH√îNG PH·∫¢I DATA!

  // ‚úÖ ƒê√öNG:
  const correctData = await fetchUserPromise(1);
  console.log(correctData); // { id: 1, name: 'John Doe' }
}

// ‚ùå ANTI-PATTERN: Kh√¥ng c·∫ßn thi·∫øt d√πng async
async function unnecessaryAsync() {
  return 42; // ‚ùå Kh√¥ng c√≥ await n√†o ‚Üí kh√¥ng c·∫ßn async
}

// ‚úÖ ƒê√öNG:
function justReturnValue() {
  return 42; // ƒê∆°n gi·∫£n h∆°n
}
```

**‚ö†Ô∏è L∆ØU √ù QUAN TR·ªåNG:**

> Trong kh√≥a h·ªçc n√†y, ch√∫ng ta **CH·ªà H·ªåC CONCEPTS** c·ªßa Promises/async/await.  
> Ch√∫ng ta s·∫Ω TH·ª∞C S·ª∞ S·ª¨ D·ª§NG ch√∫ng t·ª´ **Ng√†y 19** (Data Fetching).  
> H√¥m nay t·∫≠p trung v√†o **HI·ªÇU** c√°ch ho·∫°t ƒë·ªông!

---

### Demo 2: ES6 Modules ‚≠ê‚≠ê

#### A. Export Patterns

```javascript
// ========================================
// FILE: utils.js
// ========================================

// ‚úÖ PATTERN 1: Named Exports (khuy·∫øn ngh·ªã cho utilities)
export const API_URL = "https://api.example.com";
export const MAX_RETRIES = 3;

export function formatDate(date) {
  return date.toISOString().split("T")[0];
}

export function capitalize(str) {
  return str.charAt(0).toUpperCase() + str.slice(1);
}

// ‚úÖ PATTERN 2: Export t·∫≠p trung
const formatCurrency = (amount) => {
  return `$${amount.toFixed(2)}`;
};

const formatPercentage = (value) => {
  return `${(value * 100).toFixed(1)}%`;
};

export { formatCurrency, formatPercentage };

// ========================================
// FILE: User.js
// ========================================

// ‚úÖ PATTERN 3: Default Export (cho main export)
class User {
  constructor(name, email) {
    this.name = name;
    this.email = email;
  }

  greet() {
    return `Hello, ${this.name}!`;
  }
}

export default User;

// ‚ö†Ô∏è CH√ö √ù: C√≥ th·ªÉ combine default + named exports
export const USER_ROLES = {
  ADMIN: "admin",
  USER: "user",
  GUEST: "guest",
};

// ========================================
// FILE: validators.js
// ========================================

// ‚úÖ PATTERN 4: Re-export (aggregation pattern)
export { formatDate, formatCurrency } from "./utils.js";
export { default as User, USER_ROLES } from "./User.js";

// Gi·ªù c√≥ th·ªÉ import t·∫•t c·∫£ t·ª´ 1 file:
// import { formatDate, User, USER_ROLES } from './validators.js';
```

#### B. Import Patterns

```javascript
// ========================================
// FILE: app.js
// ========================================

// ‚úÖ IMPORT 1: Named imports
import { formatDate, capitalize, API_URL } from "./utils.js";

console.log(formatDate(new Date())); // 2024-01-06
console.log(capitalize("hello")); // Hello
console.log(API_URL); // https://api.example.com

// ‚úÖ IMPORT 2: Default import
import User from "./User.js"; // T√™n c√≥ th·ªÉ t√πy ch·ªçn

const user = new User("John", "john@example.com");
console.log(user.greet()); // Hello, John!

// ‚úÖ IMPORT 3: Rename imports
import { formatCurrency as formatMoney } from "./utils.js";
console.log(formatMoney(99.99)); // $99.99

// ‚úÖ IMPORT 4: Import all as namespace
import * as Utils from "./utils.js";

console.log(Utils.API_URL);
console.log(Utils.formatDate(new Date()));
console.log(Utils.capitalize("world"));

// ‚úÖ IMPORT 5: Combined import
import User, { USER_ROLES } from "./User.js";

const admin = new User("Admin", "admin@example.com");
console.log(admin.greet());
console.log(USER_ROLES.ADMIN); // 'admin'

// ‚ùå ANTI-PATTERN 1: Import default as named
// import { User } from './User.js'; // ‚ùå SAI! User l√† default export

// ‚ùå ANTI-PATTERN 2: Import named as default
// import formatDate from './utils.js'; // ‚ùå SAI! formatDate l√† named export

// ‚úÖ ƒê√öNG:
import User from "./User.js"; // Default import
import { formatDate } from "./utils.js"; // Named import
```

**üìä Decision Tree: Khi n√†o d√πng g√¨?**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ C·∫ßn export t·ª´ file?             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚îú‚îÄ File c√≥ 1 "main thing"? ‚Üí Default export
         ‚îÇ  (VD: User class, Button component)
         ‚îÇ
         ‚îú‚îÄ File c√≥ nhi·ªÅu utilities? ‚Üí Named exports
         ‚îÇ  (VD: formatDate, capitalize, sum...)
         ‚îÇ
         ‚îî‚îÄ C·∫£ hai? ‚Üí Default + Named exports
            (VD: User class + USER_ROLES constant)
```

---

### Demo 3: Optional Chaining & Nullish Coalescing ‚≠ê‚≠ê‚≠ê

#### A. Optional Chaining (?.)

```javascript
// ========================================
// DEMO: Optional Chaining
// ========================================

// Setup: Nested object
const user = {
  name: "John",
  profile: {
    bio: "Software Developer",
    social: {
      twitter: "@johndoe",
    },
  },
};

const userWithoutProfile = {
  name: "Jane",
  // Kh√¥ng c√≥ profile
};

// ‚ùå C√ÅCH SAI: Traditional null checks
function getTwitterOld(user) {
  if (
    user &&
    user.profile &&
    user.profile.social &&
    user.profile.social.twitter
  ) {
    return user.profile.social.twitter;
  }
  return null;
}

console.log(getTwitterOld(user)); // @johndoe
console.log(getTwitterOld(userWithoutProfile)); // null

// ‚úÖ C√ÅCH ƒê√öNG: Optional chaining
function getTwitterNew(user) {
  return user?.profile?.social?.twitter ?? null;
}

console.log(getTwitterNew(user)); // @johndoe
console.log(getTwitterNew(userWithoutProfile)); // null
console.log(getTwitterNew(null)); // null (kh√¥ng crash!)

// üéØ USE CASES

// USE CASE 1: Object property access
const address = user?.profile?.address?.city; // undefined (kh√¥ng crash)

// USE CASE 2: Array access
const users = [user, userWithoutProfile];
const firstUserTwitter = users[0]?.profile?.social?.twitter; // @johndoe
const thirdUserTwitter = users[2]?.profile?.social?.twitter; // undefined (kh√¥ng crash)

// USE CASE 3: Function calls
const onSave = user?.handleSave?.(); // Call n·∫øu method t·ªìn t·∫°i
const onSaveWithArgs = user?.handleSave?.(data); // V·ªõi arguments

// USE CASE 4: Dynamic property access
const fieldName = "twitter";
const socialHandle = user?.profile?.social?.[fieldName]; // @johndoe

// ‚ö†Ô∏è QUAN TR·ªåNG: Optional chaining ch·ªâ check null/undefined
console.log(user?.name); // 'John'
console.log(user?.age); // undefined
console.log(null?.anything); // undefined
console.log(undefined?.anything); // undefined

// ‚ùå KH√îNG check falsy values kh√°c
const emptyString = "";
console.log(emptyString?.length); // 0 (v·∫´n ch·∫°y v√¨ '' kh√¥ng ph·∫£i null/undefined)

const zero = 0;
console.log(zero?.toString()); // '0' (v·∫´n ch·∫°y v√¨ 0 kh√¥ng ph·∫£i null/undefined)
```

#### B. Nullish Coalescing (??)

```javascript
// ========================================
// DEMO: Nullish Coalescing
// ========================================

// ‚ùå V·∫§N ƒê·ªÄ v·ªõi OR operator (||)
const settings = {
  darkMode: false,
  notifications: 0,
  volume: "",
  autoSave: null,
};

// ‚ùå SAI: OR operator
const darkMode1 = settings.darkMode || true;
console.log(darkMode1); // true (SAI! Mong mu·ªën false)

const volume1 = settings.volume || 50;
console.log(volume1); // 50 (SAI! Mong mu·ªën '')

const notifications1 = settings.notifications || 10;
console.log(notifications1); // 10 (SAI! Mong mu·ªën 0)

// ‚úÖ ƒê√öNG: Nullish coalescing operator
const darkMode2 = settings.darkMode ?? true;
console.log(darkMode2); // false (ƒê√öNG!)

const volume2 = settings.volume ?? 50;
console.log(volume2); // '' (ƒê√öNG!)

const notifications2 = settings.notifications ?? 10;
console.log(notifications2); // 0 (ƒê√öNG!)

const autoSave = settings.autoSave ?? true;
console.log(autoSave); // true (ƒê√öNG! autoSave l√† null)

// üìä SO S√ÅNH || vs ??

const testValues = [null, undefined, false, 0, "", "value"];

console.log("=== Comparing || vs ?? ===");
testValues.forEach((val) => {
  const withOr = val || "default";
  const withNullish = val ?? "default";
  console.log(`Value: ${val}`);
  console.log(`  || : ${withOr}`);
  console.log(`  ?? : ${withNullish}`);
});

// Output:
// Value: null
//   || : default
//   ?? : default  ‚úÖ C·∫£ hai ƒë·ªÅu d√πng default

// Value: undefined
//   || : default
//   ?? : default  ‚úÖ C·∫£ hai ƒë·ªÅu d√πng default

// Value: false
//   || : default  ‚ùå Sai! false l√† valid value
//   ?? : false    ‚úÖ Gi·ªØ nguy√™n false

// Value: 0
//   || : default  ‚ùå Sai! 0 l√† valid number
//   ?? : 0        ‚úÖ Gi·ªØ nguy√™n 0

// Value: ''
//   || : default  ‚ùå Sai! '' l√† valid string
//   ?? :          ‚úÖ Gi·ªØ nguy√™n ''

// Value: value
//   || : value
//   ?? : value    ‚úÖ C·∫£ hai ƒë·ªÅu gi·ªØ nguy√™n

// üéØ COMBINING ?. v√† ??
const getUsername = (user) => {
  return user?.profile?.username ?? "Anonymous";
};

console.log(getUsername(user)); // 'John' (n·∫øu c√≥ username)
console.log(getUsername(userWithoutProfile)); // 'Anonymous'
console.log(getUsername(null)); // 'Anonymous'
```

---

#### C. Real-world Examples

```javascript
// ========================================
// DEMO: Real-world Use Cases
// ========================================

// USE CASE 1: API Response handling
function processUserData(apiResponse) {
  // ‚úÖ Safe access v·ªõi optional chaining
  const userName = apiResponse?.data?.user?.name ?? "Unknown User";
  const email = apiResponse?.data?.user?.email ?? "no-email@example.com";
  const age = apiResponse?.data?.user?.age ?? 0; // 0 l√† default h·ª£p l√Ω

  // ‚úÖ Safe method calls
  const welcomeMessage = apiResponse?.data?.getMessage?.() ?? "Welcome!";

  return {
    userName,
    email,
    age,
    welcomeMessage,
  };
}

// Test v·ªõi different responses
console.log(
  processUserData({
    data: {
      user: {
        name: "John",
        email: "john@example.com",
        age: 25,
      },
    },
  }),
);
// { userName: 'John', email: 'john@example.com', age: 25, welcomeMessage: 'Welcome!' }

console.log(processUserData({}));
// { userName: 'Unknown User', email: 'no-email@example.com', age: 0, welcomeMessage: 'Welcome!' }

console.log(processUserData(null));
// { userName: 'Unknown User', email: 'no-email@example.com', age: 0, welcomeMessage: 'Welcome!' }

// USE CASE 2: Configuration objects
function initializeApp(config) {
  const settings = {
    theme: config?.theme ?? "light",
    language: config?.language ?? "en",
    debug: config?.debug ?? false, // false l√† valid value!
    maxRetries: config?.maxRetries ?? 3,
    timeout: config?.timeout ?? 5000,
  };

  return settings;
}

console.log(initializeApp({ theme: "dark", debug: false }));
// { theme: 'dark', language: 'en', debug: false, maxRetries: 3, timeout: 5000 }

console.log(initializeApp(null));
// { theme: 'light', language: 'en', debug: false, maxRetries: 3, timeout: 5000 }

// USE CASE 3: Form data v·ªõi potential nulls
function getFormData(formState) {
  return {
    firstName: formState?.firstName?.trim() ?? "",
    lastName: formState?.lastName?.trim() ?? "",
    age: formState?.age ?? null, // null c√≥ √Ω nghƒ©a: ch∆∞a nh·∫≠p
    acceptTerms: formState?.acceptTerms ?? false, // false: ch∆∞a ch·∫•p nh·∫≠n
  };
}
```

---

### Demo 4: Array Methods N√¢ng Cao ‚≠ê‚≠ê‚≠ê

```javascript
// ========================================
// DEMO: Advanced Array Methods
// ========================================

// Sample data
const products = [
  {
    id: 1,
    name: "Laptop",
    price: 1000,
    inStock: true,
    category: "Electronics",
  },
  { id: 2, name: "Mouse", price: 25, inStock: true, category: "Electronics" },
  {
    id: 3,
    name: "Keyboard",
    price: 75,
    inStock: false,
    category: "Electronics",
  },
  {
    id: 4,
    name: "Monitor",
    price: 300,
    inStock: true,
    category: "Electronics",
  },
  { id: 5, name: "Desk", price: 200, inStock: true, category: "Furniture" },
];

// ========================================
// METHOD 1: find() - T√¨m element ƒë·∫ßu ti√™n th·ªèa ƒëi·ªÅu ki·ªán
// ========================================

// ‚úÖ USE CASE: T√¨m product theo ID
const findProductById = (id) => {
  return products.find((product) => product.id === id);
};

console.log(findProductById(3));
// { id: 3, name: 'Keyboard', price: 75, inStock: false, category: 'Electronics' }

console.log(findProductById(999));
// undefined (kh√¥ng t√¨m th·∫•y)

// ‚úÖ USE CASE: T√¨m product out of stock
const outOfStockProduct = products.find((p) => !p.inStock);
console.log(outOfStockProduct);
// { id: 3, name: 'Keyboard', ... }

// ‚ùå ANTI-PATTERN: D√πng filter r·ªìi l·∫•y [0]
const wrong = products.filter((p) => p.id === 3)[0]; // ‚ùå Kh√¥ng hi·ªáu qu·∫£
// filter() duy·ªát H·∫æT array, find() d·ª´ng khi t√¨m th·∫•y!

// ========================================
// METHOD 2: findIndex() - T√¨m index c·ªßa element
// ========================================

// ‚úÖ USE CASE: T√¨m v·ªã tr√≠ ƒë·ªÉ update/delete
const keyboardIndex = products.findIndex((p) => p.name === "Keyboard");
console.log(keyboardIndex); // 2

// ‚úÖ USE CASE: Check n·∫øu kh√¥ng t·ªìn t·∫°i
const notFoundIndex = products.findIndex((p) => p.name === "Chair");
console.log(notFoundIndex); // -1 (kh√¥ng t√¨m th·∫•y)

if (notFoundIndex === -1) {
  console.log("Product not found");
}

// ========================================
// METHOD 3: some() - Check N·∫æU C√ì √çT NH·∫§T 1
// ========================================

// ‚úÖ USE CASE: Check c√≥ s·∫£n ph·∫©m h·∫øt h√†ng kh√¥ng?
const hasOutOfStock = products.some((p) => !p.inStock);
console.log(hasOutOfStock); // true

// ‚úÖ USE CASE: Check c√≥ s·∫£n ph·∫©m ƒë·∫Øt kh√¥ng?
const hasExpensiveProduct = products.some((p) => p.price > 500);
console.log(hasExpensiveProduct); // true (Laptop = 1000)

// ‚úÖ USE CASE: Validation
const allPricesValid = products.some((p) => p.price < 0);
console.log(allPricesValid); // false (kh√¥ng c√≥ gi√° √¢m)

// ‚ùå ANTI-PATTERN: D√πng filter().length > 0
const wrong2 = products.filter((p) => p.price > 500).length > 0; // ‚ùå
// filter() duy·ªát H·∫æT array, some() d·ª´ng khi t√¨m th·∫•y!

// ========================================
// METHOD 4: every() - Check T·∫§T C·∫¢
// ========================================

// ‚úÖ USE CASE: Check T·∫§T C·∫¢ c√≥ s·∫µn h√†ng?
const allInStock = products.every((p) => p.inStock);
console.log(allInStock); // false (c√≥ 1 c√°i out of stock)

// ‚úÖ USE CASE: Validation - T·∫§T C·∫¢ c√≥ gi√° h·ª£p l·ªá?
const allPricesPositive = products.every((p) => p.price > 0);
console.log(allPricesPositive); // true

// ‚úÖ USE CASE: Check T·∫§T C·∫¢ thu·ªôc category
const allElectronics = products.every((p) => p.category === "Electronics");
console.log(allElectronics); // false (c√≥ Desk l√† Furniture)

// üìä SO S√ÅNH some() vs every()
console.log("\n=== some() vs every() ===");
const numbers = [2, 4, 6, 7, 8];

console.log(
  "C√≥ s·ªë ch·∫µn?",
  numbers.some((n) => n % 2 === 0),
); // true
console.log(
  "T·∫§T C·∫¢ ch·∫µn?",
  numbers.every((n) => n % 2 === 0),
); // false

// ========================================
// METHOD 5: Object.keys() / values() / entries()
// ========================================

const user = {
  name: "John",
  age: 30,
  email: "john@example.com",
  role: "admin",
};

// ‚úÖ Object.keys() - L·∫•y m·∫£ng keys
const keys = Object.keys(user);
console.log(keys);
// ['name', 'age', 'email', 'role']

// ‚úÖ USE CASE: Loop qua keys
keys.forEach((key) => {
  console.log(`${key}: ${user[key]}`);
});

// ‚úÖ Object.values() - L·∫•y m·∫£ng values
const values = Object.values(user);
console.log(values);
// ['John', 30, 'john@example.com', 'admin']

// ‚úÖ USE CASE: Check n·∫øu c√≥ value
const hasAdmin = values.includes("admin");
console.log(hasAdmin); // true

// ‚úÖ Object.entries() - L·∫•y m·∫£ng [key, value] pairs
const entries = Object.entries(user);
console.log(entries);
// [
//   ['name', 'John'],
//   ['age', 30],
//   ['email', 'john@example.com'],
//   ['role', 'admin']
// ]

// ‚úÖ USE CASE: Loop v·ªõi destructuring
entries.forEach(([key, value]) => {
  console.log(`${key}: ${value}`);
});

// ‚úÖ USE CASE: Filter object properties
const filteredEntries = entries.filter(([key, value]) => {
  return typeof value === "string";
});

const stringFieldsOnly = Object.fromEntries(filteredEntries);
console.log(stringFieldsOnly);
// { name: 'John', email: 'john@example.com', role: 'admin' }

// ‚úÖ USE CASE: Transform object
const uppercasedUser = Object.fromEntries(
  entries.map(([key, value]) => {
    return [key, typeof value === "string" ? value.toUpperCase() : value];
  }),
);
console.log(uppercasedUser);
// { name: 'JOHN', age: 30, email: 'JOHN@EXAMPLE.COM', role: 'ADMIN' }

// ========================================
// COMBINING METHODS - Real-world Example
// ========================================

// ‚úÖ SCENARIO: Product search & filter
function searchProducts(query, filters = {}) {
  let results = products;

  // Filter by search query
  if (query) {
    results = results.filter((p) =>
      p.name.toLowerCase().includes(query.toLowerCase()),
    );
  }

  // Filter by inStock
  if (filters.inStock !== undefined) {
    results = results.filter((p) => p.inStock === filters.inStock);
  }

  // Filter by price range
  if (filters.minPrice !== undefined) {
    results = results.filter((p) => p.price >= filters.minPrice);
  }

  if (filters.maxPrice !== undefined) {
    results = results.filter((p) => p.price <= filters.maxPrice);
  }

  // Filter by category
  if (filters.category) {
    results = results.filter((p) => p.category === filters.category);
  }

  return results;
}

// Test
console.log(searchProducts("", { inStock: true, minPrice: 50 }));
// [Laptop, Keyboard, Monitor, Desk] - s·∫£n ph·∫©m c√≥ s·∫µn, gi√° >= 50

console.log(searchProducts("key", {}));
// [Keyboard]

// ‚úÖ SCENARIO: Cart calculations
const cart = [
  { productId: 1, quantity: 2 }, // Laptop x 2
  { productId: 2, quantity: 1 }, // Mouse x 1
];

function calculateCartTotal(cart) {
  return cart.reduce((total, item) => {
    const product = products.find((p) => p.id === item.productId);
    return total + (product ? product.price * item.quantity : 0);
  }, 0);
}

console.log(calculateCartTotal(cart));
// 2025 (1000*2 + 25*1)

// ‚úÖ SCENARIO: Check n·∫øu cart h·ª£p l·ªá
function isCartValid(cart) {
  return cart.every((item) => {
    const product = products.find((p) => p.id === item.productId);
    return product && product.inStock && item.quantity > 0;
  });
}

console.log(isCartValid(cart)); // true ho·∫∑c false
```

**üìä Method Selection Matrix:**

| Method        | Returns                | Stops Early? | Use when                           |
| ------------- | ---------------------- | ------------ | ---------------------------------- |
| `find()`      | Element ho·∫∑c undefined | ‚úÖ Yes       | T√¨m 1 element                      |
| `findIndex()` | Index ho·∫∑c -1          | ‚úÖ Yes       | T√¨m v·ªã tr√≠ element                 |
| `some()`      | Boolean                | ‚úÖ Yes       | Check √çT NH·∫§T 1 th·ªèa ƒëi·ªÅu ki·ªán     |
| `every()`     | Boolean                | ‚úÖ Yes       | Check T·∫§T C·∫¢ th·ªèa ƒëi·ªÅu ki·ªán        |
| `filter()`    | Array                  | ‚ùå No        | L·∫•y T·∫§T C·∫¢ elements th·ªèa ƒëi·ªÅu ki·ªán |
| `map()`       | Array                  | ‚ùå No        | Transform m·ªçi element              |

---

## üî® PH·∫¶N 3: B√ÄI T·∫¨P TH·ª∞C H√ÄNH (60 ph√∫t)

### ‚≠ê Exercise 1: Promises Basic Practice (15 ph√∫t)

```javascript
/**
 * üéØ M·ª•c ti√™u: Hi·ªÉu c√°ch t·∫°o v√† s·ª≠ d·ª•ng Promise c∆° b·∫£n
 * ‚è±Ô∏è Th·ªùi gian: 15 ph√∫t
 * üö´ KH√îNG d√πng: async/await (ch∆∞a th·ª±c h√†nh s√¢u), fetch API, external libraries
 *
 * Requirements:
 * 1. T·∫°o Promise simulates API call
 * 2. Handle success case
 * 3. Handle error case
 * 4. Chain multiple promises
 *
 * üí° G·ª£i √Ω: D√πng setTimeout ƒë·ªÉ simulate async operation
 */

// ‚ùå C√ÅCH SAI: Kh√¥ng handle errors
function fetchDataWrong(id) {
  return new Promise((resolve) => {
    // ‚ùå Thi·∫øu reject!
    setTimeout(() => {
      resolve({ id, name: "John" });
    }, 1000);
  });
}

// Problem: Kh√¥ng th·ªÉ handle errors!
fetchDataWrong(1).then((data) => console.log(data));
// N·∫øu c√≥ l·ªói x·∫£y ra ‚Üí kh√¥ng b·∫Øt ƒë∆∞·ª£c!

// ‚úÖ C√ÅCH ƒê√öNG: Handle c·∫£ success v√† error
function fetchDataCorrect(id) {
  return new Promise((resolve, reject) => {
    // ‚úÖ C√≥ reject
    setTimeout(() => {
      if (id > 0) {
        resolve({ id, name: "John" });
      } else {
        reject(new Error("Invalid ID")); // ‚úÖ Reject v·ªõi meaningful error
      }
    }, 1000);
  });
}

// S·ª≠ d·ª•ng ƒë√∫ng:
fetchDataCorrect(1)
  .then((data) => {
    console.log("Success:", data);
    return data.id; // ‚úÖ Return value cho promise ti·∫øp theo
  })
  .then((id) => {
    console.log("ID:", id);
  })
  .catch((error) => {
    console.error("Error:", error.message);
  });

// üéØ NHI·ªÜM V·ª§ C·ª¶A B·∫†N:

// TODO 1: T·∫°o function fetchUser tr·∫£ v·ªÅ Promise
// - Input: userId (number)
// - N·∫øu userId > 0: resolve v·ªõi { id: userId, name: 'User ' + userId }
// - N·∫øu userId <= 0: reject v·ªõi Error('Invalid user ID')
// - Delay: 1 second

function fetchUser(userId) {
  // YOUR CODE HERE
}

// TODO 2: T·∫°o function fetchPosts tr·∫£ v·ªÅ Promise
// - Input: userId (number)
// - Resolve v·ªõi array of posts: [{ id: 1, title: 'Post 1', userId }, { id: 2, title: 'Post 2', userId }]
// - Delay: 1 second

function fetchPosts(userId) {
  // YOUR CODE HERE
}

// TODO 3: Chain 2 promises tr√™n
// - Fetch user v·ªõi ID = 1
// - Sau ƒë√≥ fetch posts c·ªßa user ƒë√≥
// - Log ra console: user v√† posts
// - Handle errors

// YOUR CODE HERE

// üìù Test cases:
// fetchUser(1) ‚Üí should resolve
// fetchUser(0) ‚Üí should reject
// fetchUser(1).then(() => fetchPosts(1)) ‚Üí should resolve

/**
 * ‚úÖ SOLUTION: Promises Basic Practice
 */

// TODO 1: T·∫°o function fetchUser
function fetchUser(userId) {
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      if (userId > 0) {
        resolve({
          id: userId,
          name: `User ${userId}`,
        });
      } else {
        reject(new Error("Invalid user ID"));
      }
    }, 1000);
  });
}

// TODO 2: T·∫°o function fetchPosts
function fetchPosts(userId) {
  return new Promise((resolve) => {
    setTimeout(() => {
      resolve([
        { id: 1, title: "Post 1", userId },
        { id: 2, title: "Post 2", userId },
      ]);
    }, 1000);
  });
}

// TODO 3: Chain promises
console.log("Fetching user and posts...");

fetchUser(1)
  .then((user) => {
    console.log("‚úÖ User fetched:", user);
    return fetchPosts(user.id); // Chain next promise
  })
  .then((posts) => {
    console.log("‚úÖ Posts fetched:", posts);
  })
  .catch((error) => {
    console.error("‚ùå Error:", error.message);
  });

// Test error case
fetchUser(0)
  .then((user) => console.log(user))
  .catch((error) => console.error("‚ùå Expected error:", error.message));

/**
 * üéì KEY LEARNINGS:
 * 1. Promise nh·∫≠n 2 params: resolve, reject
 * 2. Lu√¥n handle c·∫£ success (then) v√† error (catch)
 * 3. Return value trong then ƒë·ªÉ chain promises
 * 4. Reject v·ªõi Error object (c√≥ message)
 */
```

### ‚≠ê‚≠ê Exercise 2: ES6 Modules Practice (25 ph√∫t)

```javascript
/**
 * üéØ M·ª•c ti√™u: Th·ª±c h√†nh import/export patterns
 * ‚è±Ô∏è Th·ªùi gian: 25 ph√∫t
 *
 * Scenario: B·∫°n ƒëang x√¢y d·ª±ng utility library cho React app
 *
 * ü§î PH√ÇN T√çCH:
 * Approach A: T·∫•t c·∫£ trong 1 file utils.js
 * Pros: ƒê∆°n gi·∫£n, d·ªÖ t√¨m
 * Cons: File qu√° l·ªõn, kh√≥ maintain
 *
 * Approach B: Split th√†nh nhi·ªÅu files, re-export t·ª´ index
 * Pros: Organized, easy to maintain
 * Cons: Ph·ª©c t·∫°p h∆°n m·ªôt ch√∫t
 *
 * üí≠ CH·ªåN APPROACH B - Better for large projects
 */

// ========================================
// FILE STRUCTURE:
// src/
//   utils/
//     string.js
//     number.js
//     date.js
//     index.js (re-exports)
//   app.js
// ========================================

// TODO 1: T·∫°o file string.js v·ªõi c√°c functions:
// - capitalize(str): Vi·∫øt hoa ch·ªØ c√°i ƒë·∫ßu
// - slugify(str): 'Hello World' -> 'hello-world'
// - truncate(str, length): C·∫Øt string v√† th√™m '...'

// FILE: utils/string.js
// YOUR CODE HERE
// Hints:
// - Export named cho multiple utilities
// - Pure functions (no side effects)
// - Handle edge cases (null, undefined, empty string)

// TODO 2: T·∫°o file number.js v·ªõi c√°c functions:
// - formatCurrency(amount): 1234.5 -> '$1,234.50'
// - formatPercentage(value): 0.156 -> '15.6%'
// - clamp(value, min, max): Gi·ªõi h·∫°n value trong range

// FILE: utils/number.js
// YOUR CODE HERE

// TODO 3: T·∫°o file date.js v·ªõi c√°c functions:
// - formatDate(date): Date -> 'YYYY-MM-DD'
// - getRelativeTime(date): 'ago 2 hours ago'
// - isToday(date): Check n·∫øu l√† h√¥m nay

// FILE: utils/date.js
// YOUR CODE HERE

// TODO 4: T·∫°o file index.js re-export t·∫•t c·∫£
// FILE: utils/index.js
// YOUR CODE HERE
// Hint: export { ... } from './string.js'

// TODO 5: S·ª≠ d·ª•ng trong app.js
// FILE: app.js
// Import t·∫•t c·∫£ v√† s·ª≠ d·ª•ng
// YOUR CODE HERE

// üìù Test cases:
const testString = " Hello World ";
const testNumber = 1234.567;
const testDate = new Date();

// Expected usage:
// capitalize(testString) -> 'Hello world'
// formatCurrency(testNumber) -> '$1,234.57'
// formatDate(testDate) -> '2024-01-06'
```

<details>
<summary>üí° Solution</summary>

#### üìÅ `src/utils/string.js`

```javascript
// utils/string.js

export function capitalize(str) {
  if (typeof str !== "string") return "";
  const trimmed = str.trim();
  if (!trimmed) return "";
  return trimmed.charAt(0).toUpperCase() + trimmed.slice(1).toLowerCase();
}

export function slugify(str) {
  if (typeof str !== "string") return "";
  return str
    .trim()
    .toLowerCase()
    .replace(/[^a-z0-9\s-]/g, "")
    .replace(/\s+/g, "-")
    .replace(/-+/g, "-");
}

export function truncate(str, length) {
  if (typeof str !== "string") return "";
  if (typeof length !== "number" || length <= 0) return "";
  if (str.length <= length) return str;
  return str.slice(0, length) + "...";
}
```

---

#### üìÅ `src/utils/number.js`

```javascript
// utils/number.js

export function formatCurrency(amount) {
  if (typeof amount !== "number" || isNaN(amount)) return "$0.00";
  return amount.toLocaleString("en-US", {
    style: "currency",
    currency: "USD",
  });
}

export function formatPercentage(value) {
  if (typeof value !== "number" || isNaN(value)) return "0%";
  return `${(value * 100).toFixed(1)}%`;
}

export function clamp(value, min, max) {
  if ([value, min, max].some((v) => typeof v !== "number")) return min;
  return Math.min(Math.max(value, min), max);
}
```

---

#### üìÅ `src/utils/date.js`

```javascript
// utils/date.js

export function formatDate(date) {
  if (!(date instanceof Date) || isNaN(date)) return "";
  return date.toISOString().split("T")[0];
}

export function isToday(date) {
  if (!(date instanceof Date)) return false;
  const today = new Date();
  return (
    date.getDate() === today.getDate() &&
    date.getMonth() === today.getMonth() &&
    date.getFullYear() === today.getFullYear()
  );
}

export function getRelativeTime(date) {
  if (!(date instanceof Date)) return "";

  const diffMs = Date.now() - date.getTime();
  const diffSeconds = Math.floor(diffMs / 1000);
  const diffMinutes = Math.floor(diffSeconds / 60);
  const diffHours = Math.floor(diffMinutes / 60);
  const diffDays = Math.floor(diffHours / 24);

  if (diffSeconds < 60) return "just now";
  if (diffMinutes < 60) return `${diffMinutes} minutes ago`;
  if (diffHours < 24) return `${diffHours} hours ago`;
  return `${diffDays} days ago`;
}
```

---

#### üìÅ `src/utils/index.js` (re-export)

```javascript
// utils/index.js

export * from "./string.js";
export * from "./number.js";
export * from "./date.js";
```

---

#### üìÅ `src/app.js` (s·ª≠ d·ª•ng)

```javascript
// app.js

import {
  capitalize,
  slugify,
  truncate,
  formatCurrency,
  formatPercentage,
  clamp,
  formatDate,
  getRelativeTime,
  isToday,
} from "./utils/index.js";

// Test cases
const testString = " Hello World ";
const testNumber = 1234.567;
const testDate = new Date();

console.log(capitalize(testString)); // 'Hello world'
console.log(slugify(testString)); // 'hello-world'
console.log(truncate(testString, 5)); // ' Hell...'

console.log(formatCurrency(testNumber)); // '$1,234.57'
console.log(formatPercentage(0.156)); // '15.6%'
console.log(clamp(15, 0, 10)); // 10

console.log(formatDate(testDate)); // 'YYYY-MM-DD'
console.log(getRelativeTime(testDate)); // 'just now'
console.log(isToday(testDate)); // true
```

---

#### ‚úÖ T·ªïng k·∫øt best practices ƒë√£ √°p d·ª•ng

- ‚úîÔ∏è **Named exports** ‚Üí tree-shaking t·ªët cho React
- ‚úîÔ∏è **Pure functions**
- ‚úîÔ∏è **Centralized re-export (`index.js`)**
- ‚úîÔ∏è **Edge cases handled**
- ‚úîÔ∏è Scalable cho project l·ªõn

</details>

### ‚≠ê‚≠ê‚≠ê Exercise 3: Optional Chaining & Real-world Scenario (40 ph√∫t)

```javascript
/**
 * üéØ M·ª•c ti√™u: X·ª≠ l√Ω nested data an to√†n v·ªõi ?. v√† ??
 * ‚è±Ô∏è Th·ªùi gian: 40 ph√∫t
 *
 * üìã Product Requirements:
 * User Story: "L√† developer, t√¥i mu·ªën x·ª≠ l√Ω API response an to√†n,
 * tr√°nh crashes khi data structure thay ƒë·ªïi"
 *
 * ‚úÖ Acceptance Criteria:
 * - [ ] Kh√¥ng crash khi nested property kh√¥ng t·ªìn t·∫°i
 * - [ ] C√≥ default values h·ª£p l√Ω
 * - [ ] Gi·ªØ ƒë∆∞·ª£c falsy values h·ª£p l·ªá (0, false, '')
 * - [ ] Code clean, d·ªÖ ƒë·ªçc
 *
 * üé® Technical Constraints:
 * - KH√îNG d√πng try-catch ƒë·ªÉ handle missing properties
 * - PH·∫¢I d√πng ?. v√† ?? operators
 *
 * üö® Edge Cases c·∫ßn handle:
 * - API tr·∫£ v·ªÅ null/undefined
 * - Nested property kh√¥ng t·ªìn t·∫°i
 * - Array c√≥ th·ªÉ empty
 * - Method c√≥ th·ªÉ kh√¥ng t·ªìn t·∫°i
 */

// ========================================
// SAMPLE API RESPONSES
// ========================================

const fullResponse = {
  data: {
    user: {
      id: 1,
      name: "John Doe",
      email: "john@example.com",
      profile: {
        avatar: "https://avatar.com/john.jpg",
        bio: "Software Developer",
        location: {
          city: "San Francisco",
          country: "USA",
        },
        social: {
          twitter: "@johndoe",
          github: "johndoe",
        },
      },
      preferences: {
        theme: "dark",
        notifications: {
          email: true,
          push: false,
        },
      },
      stats: {
        posts: 42,
        followers: 150,
        following: 75,
      },
    },
    posts: [
      { id: 1, title: "First Post", likes: 10 },
      { id: 2, title: "Second Post", likes: 0 },
    ],
  },
  meta: {
    timestamp: Date.now(),
    version: "1.0",
  },
};

const partialResponse = {
  data: {
    user: {
      id: 2,
      name: "Jane Smith",
      email: "jane@example.com",
      // Kh√¥ng c√≥ profile, preferences, stats
    },
    // Kh√¥ng c√≥ posts
  },
};

const errorResponse = null;

const emptyResponse = {};

// ========================================
// TODO 1: T·∫°o function processUserData
// ========================================

/**
 * Process API response v√† extract user data an to√†n
 * @param {Object} response - API response
 * @returns {Object} Processed user data v·ªõi defaults
 */
function processUserData(response) {
  // YOUR CODE HERE

  // Requirements:
  // 1. Extract user info v·ªõi defaults
  // 2. Handle missing nested properties
  // 3. Keep falsy values nh∆∞ 0, false
  // 4. Return structure:
  return {
    id: null,
    name: "Anonymous",
    email: "no-email",
    avatar: "/default-avatar.png",
    bio: "",
    location: "Unknown",
    social: {
      twitter: null,
      github: null,
    },
    theme: "light",
    emailNotifications: true,
    pushNotifications: false,
    stats: {
      posts: 0,
      followers: 0,
      following: 0,
    },
  };
}
/**
 * ‚úÖ SOLUTION
 */

function processUserData(response) {
  const user = response?.data?.user;
  const profile = user?.profile;
  const preferences = user?.preferences;
  const stats = user?.stats ?? {};
  const postsLength = response?.data?.posts?.length ?? 0;

  return {
    id: user?.id ?? null,
    name: user?.name ?? "Anonymous",
    email: user?.email ?? "no-email",

    avatar: profile?.avatar ?? "/default-avatar.png",
    bio: profile?.bio ?? "",

    location:
      profile?.location?.city && profile?.location?.country
        ? `${profile?.location?.city}, ${profile?.location?.country}`
        : "Unknown",

    social: {
      twitter: profile?.social?.twitter ?? null,
      github: profile?.social?.github ?? null,
    },

    theme: preferences?.theme ?? "light",
    emailNotifications: preferences?.notifications?.email ?? true,
    pushNotifications: preferences?.notifications?.push ?? false,

    stats: {
      posts: postsLength,
      followers: stats.followers ?? 0,
      following: stats.following ?? 0,
    },
  };
}
// ========================================
// TODO 2: T·∫°o function getPostsSummary
// ========================================

/**
 * Get summary of user's posts
 * @param {Object} response - API response
 * @returns {Object} Posts summary
 */
function getPostsSummary(response) {
  // YOUR CODE HERE

  // Requirements:
  // 1. Handle missing posts array
  // 2. Calculate total posts
  // 3. Calculate total likes
  // 4. Find most liked post
  // 5. Return structure:
  return {
    totalPosts: 0,
    totalLikes: 0,
    averageLikes: 0,
    mostLikedPost: null,
  };
}
/**
 * ‚úÖ SOLUTION
 */
function getPostsSummary(response) {
  const posts = response?.data?.posts ?? [];

  // T√≠nh to√°n m·ªôt l·∫ßn duy nh·∫•t
  const totalPosts = posts.length;
  const totalLikes = posts.reduce((sum, post) => sum + (post?.likes ?? 0), 0);

  // T√¨m b√†i post c√≥ l∆∞·ª£t like cao nh·∫•t (n·∫øu c√≥ nhi·ªÅu b√†i c√πng s·ªë like ‚Üí l·∫•y b√†i ƒë·∫ßu ti√™n)
  const mostLikedPost =
    totalPosts > 0
      ? posts.reduce((max, post) =>
          (post?.likes ?? 0) > (max?.likes ?? 0) ? post : max,
        )
      : null;

  const averageLikes =
    totalPosts > 0 ? Number((totalLikes / totalPosts).toFixed(1)) : 0;

  return {
    totalPosts,
    totalLikes,
    averageLikes,
    mostLikedPost, // gi·ªØ nguy√™n object g·ªëc ho·∫∑c null
  };
}
// ========================================
// TODO 3: T·∫°o function getUserDisplayName
// ========================================

/**
 * Get user display name v·ªõi fallback logic
 * Priority: name > email username > 'User #{id}' > 'Guest'
 * @param {Object} response - API response
 * @returns {string} Display name
 */
function getUserDisplayName(response) {
  // YOUR CODE HERE
  // Hints:
  // - Check name first
  // - Extract username from email (before @)
  // - Use id n·∫øu c√≥
  // - Final fallback: 'Guest'
}
/**
 * ‚úÖ SOLUTION
 */

function getUserDisplayName(response) {
  const user = response?.data?.user;

  // Priority 1: name (n·∫øu t·ªìn t·∫°i v√† kh√¥ng ph·∫£i chu·ªói r·ªóng)
  if (user?.name?.trim()) {
    return user.name.trim();
  }

  // Priority 2: username t·ª´ email (ph·∫ßn tr∆∞·ªõc @)
  const emailUsername = user?.email?.split("@")[0]?.trim();
  if (emailUsername) {
    return emailUsername;
  }

  // Priority 3: User # + id
  if (user?.id != null) {
    return `User #${user.id}`;
  }

  // Final fallback
  return "Guest";
}

// ========================================
// TODO 4: T·∫°o function canUserPerformAction
// ========================================

/**
 * Check n·∫øu user c√≥ th·ªÉ th·ª±c hi·ªán action d·ª±a tr√™n permissions
 * @param {Object} response - API response
 * @param {string} action - Action name
 * @returns {boolean}
 */
function canUserPerformAction(response, action) {
  // YOUR CODE HERE
  // Gi·∫£ ƒë·ªãnh c·∫•u tr√∫c :
  // response.data.user.permissions = {
  //   canPost: true,
  //   canDelete: false,
  //   canEdit: true
  // }
  // Y√™u c·∫ßu:
  // - X·ª≠ l√Ω ƒë·ªëi t∆∞·ª£ng permissions b·ªã thi·∫øu
  // - X·ª≠ l√Ω permissions c·ª• th·ªÉ b·ªã thi·∫øu
  // - M·∫∑c ƒë·ªãnh: false (t·ª´ ch·ªëi theo m·∫∑c ƒë·ªãnh)
}
/**
 * ‚úÖ SOLUTION
 */
function canUserPerformAction(response, action) {
  // Ki·ªÉm tra response v√† action h·ª£p l·ªá
  if (!response || typeof action !== "string" || !action.trim()) {
    return false;
  }

  const permissions = response?.data?.user?.permissions ?? {};

  // Tr·∫£ v·ªÅ gi√° tr·ªã permission n·∫øu t·ªìn t·∫°i, ng∆∞·ª£c l·∫°i false
  return permissions[action] === true;
}

// üìù TEST CASES

console.log("=== Test processUserData ===");
console.log(processUserData(fullResponse));
// Should have all data

console.log(processUserData(partialResponse));
// Should have defaults for missing fields

console.log(processUserData(errorResponse));
// Should return all defaults, no crash

console.log(processUserData(emptyResponse));
// Should return all defaults, no crash

console.log("\n=== Test getPostsSummary ===");
console.log(getPostsSummary(fullResponse));
// { totalPosts: 2, totalLikes: 10, ... }

console.log(getPostsSummary(partialResponse));
// { totalPosts: 0, totalLikes: 0, ... }

console.log("\n=== Test getUserDisplayName ===");
console.log(getUserDisplayName(fullResponse)); // 'John Doe'
console.log(getUserDisplayName(partialResponse)); // 'Jane Smith'
console.log(getUserDisplayName(errorResponse)); // 'Guest'
console.log(
  getUserDisplayName({
    data: { user: { id: 5 } },
  }),
); // 'User #5'

console.log("\n=== Test canUserPerformAction ===");
console.log(canUserPerformAction(fullResponse, "canPost")); // depends on data
console.log(canUserPerformAction(partialResponse, "canPost")); // false
console.log(canUserPerformAction(errorResponse, "canPost")); // false
```

### ‚≠ê‚≠ê‚≠ê‚≠ê Exercise 4: Architecture Decision - Array Methods (60 ph√∫t)

```javascript
/**
 * üéØ M·ª•c ti√™u: Ch·ªçn ƒë√∫ng array method cho t·ª´ng use case
 * ‚è±Ô∏è Th·ªùi gian: 60 ph√∫t
 *
 * üèóÔ∏è PHASE 1: Research & Design (20 ph√∫t)
 *
 * Scenario: B·∫°n ƒëang x√¢y d·ª±ng Product Filter System cho e-commerce
 *
 * Features c·∫ßn implement:
 * 1. Search products by name
 * 2. Filter by price range
 * 3. Filter by availability
 * 4. Sort by different criteria
 * 5. Check inventory status
 * 6. Calculate statistics
 *
 *
 * ## Context
 * C·∫ßn x·ª≠ l√Ω large product list (100-1000 items) v·ªõi multiple filters.
 * Performance quan tr·ªçng - avoid unnecessary iterations.
 *
 * ## Decision Points
 *
 * 1. N√™n d√πng method n√†o ƒë·ªÉ search?
 *    - Option A: filter() + [0]
 *    - Option B: find()
 *    - Option C: for loop
 *
 * 2. Check inventory - any out of stock?
 *    - Option A: filter().length > 0
 *    - Option B: some()
 *    - Option C: for loop with early return
 *
 * 3. Validate all products - c√≥ gi√° h·ª£p l·ªá?
 *    - Option A: filter().length === array.length
 *    - Option B: every()
 *    - Option C: !some() with inverted condition
 *
 * TODO: Ph√¢n t√≠ch t·ª´ng option, ƒë∆∞a ra decision v√† rationale
 */
```

<details>
  <summary>üí° Solution Phase 1</summary>

```javascript
/**
 *
 * =====================================================
 * B·ªêI C·∫¢NH (CONTEXT)
 * =====================================================
 *
 * - X·ª≠ l√Ω danh s√°ch s·∫£n ph·∫©m l·ªõn (100‚Äì1000+ items),
 *   th∆∞·ªùng k·∫øt h·ª£p nhi·ªÅu filter (l·ªçc) / search (t√¨m ki·∫øm) / sort (s·∫Øp x·∫øp).
 *
 * - Hi·ªáu nƒÉng (performance) l√† y·∫øu t·ªë quan tr·ªçng:
 *   ‚Üí tr√°nh l·∫∑p th·ª´a (unnecessary iterations)
 *   ‚Üí gi·∫£m c·∫•p ph√°t b·ªô nh·ªõ (memory allocation) khi kh√¥ng c·∫ßn thi·∫øt.
 *
 * - ∆Øu ti√™n code khai b√°o (declarative):
 *   ‚Üí d·ªÖ ƒë·ªçc (readable)
 *   ‚Üí d·ªÖ b·∫£o tr√¨ (maintainable)
 *   nh∆∞ng kh√¥ng ƒë√°nh ƒë·ªïi hi·ªáu nƒÉng ƒë√°ng k·ªÉ trong quy m√¥ n√†y.
 *
 * - C√°c JS engine hi·ªán ƒë·∫°i (V8, SpiderMonkey, JavaScriptCore)
 *   ƒë√£ t·ªëi ∆∞u r·∫•t t·ªët cho array methods (c√°c h√†m x·ª≠ l√Ω m·∫£ng).
 *   ‚Üí kh√°c bi·ªát hi·ªáu nƒÉng ch·ªâ r√µ r·ªát khi array > 10k‚Äì100k ph·∫ßn t·ª≠
 *     ho·∫∑c n·∫±m trong hot path (ƒëo·∫°n code ch·∫°y r·∫•t th∆∞·ªùng xuy√™n).
 *
 * =====================================================
 * QUY·∫æT ƒê·ªäNH 1: T√åM S·∫¢N PH·∫®M THEO T√äN
 * (Ch·ªâ c·∫ßn M·ªòT s·∫£n ph·∫©m ho·∫∑c danh s√°ch kh·ªõp)
 * =====================================================
 *
 * OPTION A: filter()[0]
 * - ∆Øu ƒëi·ªÉm:
 *   + D·ªÖ vi·∫øt n·∫øu sau n√†y c·∫ßn nhi·ªÅu k·∫øt qu·∫£
 * - Nh∆∞·ª£c ƒëi·ªÉm:
 *   - Lu√¥n duy·ªát TO√ÄN B·ªò m·∫£ng d√π ch·ªâ c·∫ßn 1 k·∫øt qu·∫£
 *   - T·ªën CPU n·∫øu t√¨m th·∫•y s·ªõm
 *
 * OPTION B: find()
 * - ∆Øu ƒëi·ªÉm:
 *   + Tho√°t s·ªõm (early exit) khi t√¨m th·∫•y ph·∫ßn t·ª≠ ƒë·∫ßu ti√™n
 *   + Ph√π h·ª£p nh·∫•t cho b√†i to√°n "t√¨m m·ªôt s·∫£n ph·∫©m"
 * - Nh∆∞·ª£c ƒëi·ªÉm:
 *   - Ch·ªâ tr·∫£ v·ªÅ 1 ph·∫ßn t·ª≠ (c·∫ßn nhi·ªÅu ‚Üí d√πng filter)
 *
 * OPTION C: for loop
 * - ∆Øu ƒëi·ªÉm:
 *   + C√≥ th·ªÉ t·ªëi ∆∞u nh·∫•t v·ªÅ m·∫∑t l√Ω thuy·∫øt
 *     (return s·ªõm, kh√¥ng t·ªën chi ph√≠ g·ªçi h√†m
 *      ‚Äì no function call overhead)
 * - Nh∆∞·ª£c ƒëi·ªÉm:
 *   - Code m·ªánh l·ªánh (imperative)
 *   - D√†i d√≤ng, kh√≥ n·ªëi (chain) v·ªõi filter kh√°c
 *   - Kh√≥ ƒë·ªçc, kh√≥ b·∫£o tr√¨
 *
 * üëâ CH·ªåN: OPTION B ‚Äì find()
 *
 * L√ù DO:
 * - T√¨m theo t√™n th∆∞·ªùng ch·ªâ c·∫ßn M·ªòT s·∫£n ph·∫©m c·ª• th·ªÉ
 * - find() c√≥ tho√°t s·ªõm ‚Üí nhanh h∆°n filter() khi match n·∫±m ƒë·∫ßu/gi·ªØa m·∫£ng
 * - V·ªõi 100‚Äì1000 ph·∫ßn t·ª≠, ƒë√¢y l√† best practice (th·ª±c h√†nh t·ªët nh·∫•t)
 * - N·∫øu c·∫ßn T·∫§T C·∫¢ k·∫øt qu·∫£ kh·ªõp ‚Üí d√πng filter()
 *
 * =====================================================
 * QUY·∫æT ƒê·ªäNH 2: KI·ªÇM TRA T·ªíN KHO
 * (C√≥ s·∫£n ph·∫©m n√†o h·∫øt h√†ng kh√¥ng?)
 * =====================================================
 *
 * OPTION A: filter().length > 0
 * - ∆Øu ƒëi·ªÉm:
 *   + D·ªÖ hi·ªÉu
 * - Nh∆∞·ª£c ƒëi·ªÉm:
 *   - Duy·ªát to√†n b·ªô m·∫£ng
 *   - T·∫°o m·∫£ng m·ªõi kh√¥ng c·∫ßn thi·∫øt (t·ªën b·ªô nh·ªõ)
 *
 * OPTION B: some()
 * - ∆Øu ƒëi·ªÉm:
 *   + Tho√°t s·ªõm khi t√¨m th·∫•y M·ªòT ph·∫ßn t·ª≠ th·ªèa m√£n
 *   + T·ªëi ∆∞u cho c√¢u h·ªèi "c√≥ ... kh√¥ng?"
 * - Nh∆∞·ª£c ƒëi·ªÉm:
 *   - Kh√¥ng c√≥ trong tr∆∞·ªùng h·ª£p n√†y
 *
 * OPTION C: for loop + return s·ªõm
 * - ∆Øu ƒëi·ªÉm:
 *   + C√≥ th·ªÉ nhanh nh·∫•t v·ªÅ m·∫∑t l√Ω thuy·∫øt
 * - Nh∆∞·ª£c ƒëi·ªÉm:
 *   - Imperative, kh√≥ ƒë·ªçc, kh√≥ k·∫øt h·ª£p logic kh√°c
 *
 * üëâ CH·ªåN: OPTION B ‚Äì some()
 *
 * L√ù DO:
 * - some() ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë√∫ng cho c√¢u h·ªèi
 *   "c√≥ √≠t nh·∫•t m·ªôt ph·∫ßn t·ª≠ th·ªèa m√£n kh√¥ng?"
 * - Tho√°t s·ªõm ‚Üí hi·ªáu nƒÉng r·∫•t t·ªët n·∫øu match n·∫±m ƒë·∫ßu danh s√°ch
 * - Code r√µ r√†ng, d·ªÖ ƒë·ªçc:
 *
 *   products.some(p => p.stock === 0)
 *
 * =====================================================
 * QUY·∫æT ƒê·ªäNH 3: KI·ªÇM TRA T√çNH H·ª¢P L·ªÜ C·ª¶A GI√Å
 * (T·∫•t c·∫£ s·∫£n ph·∫©m c√≥ gi√° h·ª£p l·ªá kh√¥ng?)
 * =====================================================
 *
 * OPTION A: filter().length === array.length
 * - ∆Øu ƒëi·ªÉm:
 *   + D·ªÖ hi·ªÉu n·∫øu quen filter
 * - Nh∆∞·ª£c ƒëi·ªÉm:
 *   - Lu√¥n duy·ªát to√†n b·ªô m·∫£ng
 *   - T·∫°o m·∫£ng m·ªõi ‚Üí k√©m hi·ªáu qu·∫£
 *
 * OPTION B: every()
 * - ∆Øu ƒëi·ªÉm:
 *   + Tho√°t s·ªõm khi g·∫∑p M·ªòT ph·∫ßn t·ª≠ kh√¥ng h·ª£p l·ªá
 *   + T·ªëi ∆∞u cho validation (ki·ªÉm tra h·ª£p l·ªá)
 * - Nh∆∞·ª£c ƒëi·ªÉm:
 *   - Kh√¥ng c√≥
 *
 * OPTION C: !some() v·ªõi ƒëi·ªÅu ki·ªán ng∆∞·ª£c
 * - ∆Øu ƒëi·ªÉm:
 *   + Logic & hi·ªáu nƒÉng t∆∞∆°ng ƒë∆∞∆°ng every()
 * - Nh∆∞·ª£c ƒëi·ªÉm:
 *   - Logic "ng∆∞·ª£c", d·ªÖ g√¢y nh·∫ßm khi ƒë·ªçc
 *
 * üëâ CH·ªåN: OPTION B ‚Äì every()
 *
 * L√ù DO:
 * - every() ƒë√∫ng ng·ªØ nghƒ©a cho c√¢u h·ªèi
 *   "t·∫•t c·∫£ ph·∫ßn t·ª≠ c√≥ th·ªèa m√£n kh√¥ng?"
 * - Tho√°t s·ªõm ‚Üí kh√¥ng duy·ªát th·ª´a
 * - Code r√µ r√†ng:
 *
 *   products.every(
 *     p => p.price > 0 && Number.isFinite(p.price)
 *   )
 *
 * =====================================================
 * KHUY·∫æN NGH·ªä CHUNG (RECOMMENDATIONS)
 * =====================================================
 *
 * - Khi k·∫øt h·ª£p nhi·ªÅu filter (l·ªçc):
 *   ‚Üí ∆∞u ti√™n chaining (n·ªëi c√°c b∆∞·ªõc x·ª≠ l√Ω):
 *
 *   const filtered = products
 *     .filter(p =>
 *       p.name.toLowerCase().includes(query.toLowerCase())
 *     )
 *     .filter(p => p.price >= min && p.price <= max)
 *     .filter(p => p.stock > 0)
 *     .sort((a, b) => b.rating - a.rating);
 *
 */
```

</details>

```javascript
// ========================================
// üíª PHASE 2: Implementation (30 ph√∫t)
// ========================================

// Sample data
const products = [
  {
    id: 1,
    name: "Laptop Pro",
    price: 1299,
    inStock: true,
    category: "Electronics",
    rating: 4.5,
  },
  {
    id: 2,
    name: "Wireless Mouse",
    price: 29,
    inStock: true,
    category: "Electronics",
    rating: 4.2,
  },
  {
    id: 3,
    name: "Mechanical Keyboard",
    price: 89,
    inStock: false,
    category: "Electronics",
    rating: 4.7,
  },
  {
    id: 4,
    name: "USB-C Cable",
    price: 15,
    inStock: true,
    category: "Accessories",
    rating: 4.0,
  },
  {
    id: 5,
    name: "Monitor Stand",
    price: 45,
    inStock: true,
    category: "Accessories",
    rating: 4.3,
  },
  {
    id: 6,
    name: "4K Monitor",
    price: 399,
    inStock: false,
    category: "Electronics",
    rating: 4.8,
  },
  {
    id: 7,
    name: "Desk Lamp",
    price: 35,
    inStock: true,
    category: "Furniture",
    rating: 4.1,
  },
  {
    id: 8,
    name: "Webcam HD",
    price: 79,
    inStock: true,
    category: "Electronics",
    rating: 4.4,
  },
];

// TODO 1: Implement ProductSearch class
class ProductSearch {
  constructor(products) {
    this.products = products;
  }

  // Find product by ID (use appropriate method)
  findById(id) {
    // YOUR CODE HERE
  }

  // Search products by name (partial match)
  searchByName(query) {
    // YOUR CODE HERE
  }

  // Filter by price range
  filterByPriceRange(min, max) {
    // YOUR CODE HERE
  }

  // Filter by availability
  filterByAvailability(inStock) {
    // YOUR CODE HERE
  }

  // Filter by category
  filterByCategory(category) {
    // YOUR CODE HERE
  }

  // Complex filter - combine multiple criteria
  advancedSearch(criteria) {
    // criteria = { query, minPrice, maxPrice, inStock, category, minRating }
    // YOUR CODE HERE
    // Hint: Chain filters carefully
  }
}

// TODO 2: Implement InventoryManager class
class InventoryManager {
  constructor(products) {
    this.products = products;
  }

  // Check if ANY product is out of stock (use appropriate method)
  hasOutOfStock() {
    // YOUR CODE HERE
  }

  // Check if ALL products are in stock (use appropriate method)
  allInStock() {
    // YOUR CODE HERE
  }

  // Check if ANY product in specific category is out of stock
  categoryHasOutOfStock(category) {
    // YOUR CODE HERE
  }

  // Get first out of stock product (use appropriate method)
  getFirstOutOfStock() {
    // YOUR CODE HERE
  }

  // Get ALL out of stock products
  getAllOutOfStock() {
    // YOUR CODE HERE
  }

  // Validate inventory - check if all prices are positive
  validatePrices() {
    // YOUR CODE HERE
  }
}

// TODO 3: Implement StatsCalculator class
class StatsCalculator {
  constructor(products) {
    this.products = products;
  }

  // Calculate average price
  getAveragePrice() {
    // YOUR CODE HERE
  }

  // Get price range
  getPriceRange() {
    // Return { min, max }
    // YOUR CODE HERE
  }

  // Calculate average rating
  getAverageRating() {
    // YOUR CODE HERE
  }

  // Get top rated products (rating >= 4.5)
  getTopRated() {
    // YOUR CODE HERE
  }

  // Get category statistics
  getCategoryStats() {
    // Return object: { category: { count, avgPrice, avgRating } }
    // YOUR CODE HERE
    // Hint: Use reduce or Object.keys
  }
}
```

<details>
<summary>üí° Solution Phase 2</summary>

```javascript
/**
 * ========================================
 * üíª PHASE 2: Implementation ‚Äì Gi·∫£i ph√°p ho√†n ch·ªânh
 * ========================================
 *
 * ----------------------------------------
 * TODO 1: ProductSearch class
 * ----------------------------------------
 *
 * class ProductSearch {
 *   constructor(products) {
 *     this.products = products;
 *   }
 *
 *   // T√¨m s·∫£n ph·∫©m theo ID ‚Üí d√πng find() (early exit, ch·ªâ c·∫ßn 1)
 *   findById(id) {
 *     return this.products.find(p => p.id === id) ?? null;
 *   }
 *
 *   // T√¨m ki·∫øm theo t√™n (partial match, case-insensitive) ‚Üí filter()
 *   searchByName(query) {
 *     if (!query?.trim()) return [];
 *     const lowerQuery = query.toLowerCase().trim();
 *     return this.products.filter(p =>
 *       p.name.toLowerCase().includes(lowerQuery)
 *     );
 *   }
 *
 *   // L·ªçc theo kho·∫£ng gi√° ‚Üí filter()
 *   filterByPriceRange(min, max) {
 *     return this.products.filter(p => p.price >= min && p.price <= max);
 *   }
 *
 *   // L·ªçc theo t√¨nh tr·∫°ng t·ªìn kho ‚Üí filter()
 *   filterByAvailability(inStock) {
 *     return this.products.filter(p => p.inStock === inStock);
 *   }
 *
 *   // L·ªçc theo danh m·ª•c ‚Üí filter()
 *   filterByCategory(category) {
 *     if (!category?.trim()) return this.products;
 *     return this.products.filter(p => p.category === category);
 *   }
 *
 *   // T√¨m ki·∫øm n√¢ng cao ‚Äì chain nhi·ªÅu ƒëi·ªÅu ki·ªán
 *   advancedSearch(criteria = {}) {
 *     const {
 *       query,
 *       minPrice,
 *       maxPrice,
 *       inStock,
 *       category,
 *       minRating,
 *     } = criteria;
 *
 *     let result = this.products;
 *
 *     // Chain filter m·ªôt c√°ch c√≥ ƒëi·ªÅu ki·ªán
 *     if (query?.trim()) {
 *       const lowerQuery = query.toLowerCase().trim();
 *       result = result.filter(p =>
 *         p.name.toLowerCase().includes(lowerQuery)
 *       );
 *     }
 *
 *     if (typeof minPrice === 'number') {
 *       result = result.filter(p => p.price >= minPrice);
 *     }
 *
 *     if (typeof maxPrice === 'number') {
 *       result = result.filter(p => p.price <= maxPrice);
 *     }
 *
 *     if (typeof inStock === 'boolean') {
 *       result = result.filter(p => p.inStock === inStock);
 *     }
 *
 *     if (category?.trim()) {
 *       result = result.filter(p => p.category === category);
 *     }
 *
 *     if (typeof minRating === 'number') {
 *       result = result.filter(p => p.rating >= minRating);
 *     }
 *
 *     return result;
 *   }
 * }
 *
 * ----------------------------------------
 * TODO 2: InventoryManager class
 * ----------------------------------------
 *
 * class InventoryManager {
 *   constructor(products) {
 *     this.products = products;
 *   }
 *
 *   // C√≥ s·∫£n ph·∫©m n√†o h·∫øt h√†ng kh√¥ng? ‚Üí some() (early exit)
 *   hasOutOfStock() {
 *     return this.products.some(p => !p.inStock);
 *   }
 *
 *   // T·∫•t c·∫£ s·∫£n ph·∫©m c√≥ c√≤n h√†ng kh√¥ng? ‚Üí every()
 *   allInStock() {
 *     return this.products.every(p => p.inStock);
 *   }
 *
 *   // Danh m·ª•c c√≥ s·∫£n ph·∫©m n√†o h·∫øt h√†ng kh√¥ng? ‚Üí some()
 *   categoryHasOutOfStock(category) {
 *     return this.products.some(
 *       p => p.category === category && !p.inStock
 *     );
 *   }
 *
 *   // L·∫•y s·∫£n ph·∫©m h·∫øt h√†ng ƒë·∫ßu ti√™n ‚Üí find()
 *   getFirstOutOfStock() {
 *     return this.products.find(p => !p.inStock) ?? null;
 *   }
 *
 *   // L·∫•y t·∫•t c·∫£ s·∫£n ph·∫©m h·∫øt h√†ng ‚Üí filter()
 *   getAllOutOfStock() {
 *     return this.products.filter(p => !p.inStock);
 *   }
 *
 *   // Ki·ªÉm tra t·∫•t c·∫£ gi√° c√≥ h·ª£p l·ªá (> 0 v√† l√† s·ªë) ‚Üí every()
 *   validatePrices() {
 *     return this.products.every(p =>
 *       typeof p.price === 'number' &&
 *       p.price > 0 &&
 *       Number.isFinite(p.price)
 *     );
 *   }
 * }
 *
 * ----------------------------------------
 * TODO 3: StatsCalculator class
 * ----------------------------------------
 *
 * class StatsCalculator {
 *   constructor(products) {
 *     this.products = products;
 *   }
 *
 *   // Gi√° trung b√¨nh
 *   getAveragePrice() {
 *     if (this.products.length === 0) return 0;
 *     const total = this.products.reduce((sum, p) => sum + p.price, 0);
 *     return Number((total / this.products.length).toFixed(2));
 *   }
 *
 *   // Kho·∫£ng gi√° min-max
 *   getPriceRange() {
 *     if (this.products.length === 0) return { min: 0, max: 0 };
 *
 *     return this.products.reduce(
 *       (range, p) => ({
 *         min: Math.min(range.min, p.price),
 *         max: Math.max(range.max, p.price),
 *       }),
 *       { min: Infinity, max: -Infinity }
 *     );
 *   }
 *
 *   // ƒêi·ªÉm ƒë√°nh gi√° trung b√¨nh
 *   getAverageRating() {
 *     if (this.products.length === 0) return 0;
 *     const total = this.products.reduce((sum, p) => sum + p.rating, 0);
 *     return Number((total / this.products.length).toFixed(1));
 *   }
 *
 *   // Top s·∫£n ph·∫©m c√≥ rating >= 4.5, s·∫Øp x·∫øp gi·∫£m d·∫ßn
 *   getTopRated() {
 *     return this.products
 *       .filter(p => p.rating >= 4.5)
 *       .sort((a, b) => b.rating - a.rating);
 *   }
 *
 *   // Th·ªëng k√™ theo danh m·ª•c
 *   getCategoryStats() {
 *     return this.products.reduce((stats, p) => {
 *       const cat = p.category;
 *       if (!stats[cat]) {
 *         stats[cat] = {
 *           count: 0,
 *           avgPrice: 0,
 *           avgRating: 0,
 *           totalPrice: 0,
 *           totalRating: 0
 *         };
 *       }
 *
 *       stats[cat].count += 1;
 *       stats[cat].totalPrice += p.price;
 *       stats[cat].totalRating += p.rating;
 *
 *       // C·∫≠p nh·∫≠t trung b√¨nh
 *       stats[cat].avgPrice = Number(
 *         (stats[cat].totalPrice / stats[cat].count).toFixed(2)
 *       );
 *       stats[cat].avgRating = Number(
 *         (stats[cat].totalRating / stats[cat].count).toFixed(1)
 *       );
 *
 *       return stats;
 *     }, {});
 *   }
 * }
 *
 * const search = new ProductSearch(products);
 * console.log(search.searchByName('monitor'));
 * console.log(search.advancedSearch({ minPrice: 100, inStock: true }));
 *
 * const inventory = new InventoryManager(products);
 * console.log(inventory.hasOutOfStock());
 * console.log(inventory.allInStock());
 *
 * const stats = new StatsCalculator(products);
 * console.log(stats.getAveragePrice());
 * console.log(stats.getCategoryStats());
 */
```

</details>

```javascript
// ========================================
// üß™ PHASE 3: Testing (10 ph√∫t)
// ========================================

// Test ProductSearch
const search = new ProductSearch(products);
console.log("=== ProductSearch Tests ===");
console.log("Find ID 3:", search.findById(3));
console.log('Search "monitor":', search.searchByName("monitor"));
console.log("Price 30-100:", search.filterByPriceRange(30, 100));
console.log("In stock:", search.filterByAvailability(true));
console.log("Electronics:", search.filterByCategory("Electronics"));
console.log(
  "Advanced search:",
  search.advancedSearch({
    query: "monitor",
    minPrice: 0,
    maxPrice: 500,
    inStock: true,
    minRating: 4.0,
  }),
);

// Test InventoryManager
const inventory = new InventoryManager(products);
console.log("\n=== InventoryManager Tests ===");
console.log("Has out of stock?:", inventory.hasOutOfStock());
console.log("All in stock?:", inventory.allInStock());
console.log(
  "Electronics has out of stock?:",
  inventory.categoryHasOutOfStock("Electronics"),
);
console.log("First out of stock:", inventory.getFirstOutOfStock());
console.log("All out of stock:", inventory.getAllOutOfStock());
console.log("Prices valid?:", inventory.validatePrices());

// Test StatsCalculator
const stats = new StatsCalculator(products);
console.log("\n=== StatsCalculator Tests ===");
console.log("Average price:", stats.getAveragePrice());
console.log("Price range:", stats.getPriceRange());
console.log("Average rating:", stats.getAverageRating());
console.log("Top rated:", stats.getTopRated());
console.log("Category stats:", stats.getCategoryStats());

// üìù Manual Testing Checklist:
// - [ ] Search returns correct products
// - [ ] Filters work correctly
// - [ ] some() stops early (performance)
// - [ ] every() validates all
// - [ ] Stats calculations are accurate
// - [ ] Edge cases handled (empty results, no matches)
```

---

### ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Exercise 5: Production Challenge - Data Processing Pipeline (90 ph√∫t)

````javascript
/**
 * üéØ M·ª•c ti√™u: X√¢y d·ª±ng pipeline x·ª≠ l√Ω d·ªØ li·ªáu s·∫µn s√†ng cho production
 * ‚è±Ô∏è Th·ªùi gian: 90 ph√∫t
 *
 * üìã ƒê·∫∑c t·∫£ t√≠nh nƒÉng:
 *
 * X√¢y d·ª±ng "B·∫£ng ƒëi·ªÅu khi·ªÉn ph√¢n t√≠ch doanh s·ªë" v·ªõi c√°c t√≠nh nƒÉng:
 * 1. Import d·ªØ li·ªáu b√°n h√†ng t·ª´ nhi·ªÅu ngu·ªìn
 * 2. L√†m s·∫°ch & x√°c th·ª±c d·ªØ li·ªáu (Clean & validate data)
 * 3. Bi·∫øn ƒë·ªïi & l√†m gi√†u d·ªØ li·ªáu (Transform & enrich)
 * 4. T√≠nh to√°n c√°c ch·ªâ s·ªë ph√¢n t√≠ch (analytics)
 * 5. Xu·∫•t b√°o c√°o
 *
 * üèóÔ∏è T√†i li·ªáu thi·∫øt k·∫ø k·ªπ thu·∫≠t:
 *
 * 1. Ki·∫øn tr√∫c th√†nh ph·∫ßn:
 *    - DataImporter: Import & chu·∫©n ho√° d·ªØ li·ªáu
 *    - DataValidator: X√°c th·ª±c & l√†m s·∫°ch d·ªØ li·ªáu
 *    - DataTransformer: Bi·∫øn ƒë·ªïi & l√†m gi√†u d·ªØ li·ªáu
 *    - AnalyticsEngine: T√≠nh to√°n c√°c ch·ªâ s·ªë
 *    - ReportGenerator: T·∫°o b√°o c√°o
 *
 * 2. Lu·ªìng d·ªØ li·ªáu:
 *    D·ªØ li·ªáu th√¥ ‚Üí Import ‚Üí Validate ‚Üí Transform ‚Üí Analyze ‚Üí Report
 *
 * 3. C√°c y·∫øu t·ªë c·∫ßn c√¢n nh·∫Øc v·ªÅ hi·ªáu nƒÉng:
 *    - S·ª≠ d·ª•ng c√°c ph∆∞∆°ng th·ª©c array ph√π h·ª£p (tr√°nh l·∫∑p kh√¥ng c·∫ßn thi·∫øt)
 *    - Cache c√°c ph√©p t√≠nh khi c√≥ th·ªÉ
 *    - X·ª≠ l√Ω t·∫≠p d·ªØ li·ªáu l·ªõn (1000+ b·∫£n ghi)
 *
 * 4. Chi·∫øn l∆∞·ª£c x·ª≠ l√Ω l·ªói:
 *    - X√°c th·ª±c t·∫•t c·∫£ input
 *    - Tho√°i lui an to√†n (graceful degradation)
 *    - Th√¥ng b√°o l·ªói r√µ r√†ng, d·ªÖ hi·ªÉu
 *
 * ‚úÖ Checklist production:
 * - [ ] X·ª≠ l√Ω c√°c edge case (d·ªØ li·ªáu r·ªóng, d·ªØ li·ªáu kh√¥ng h·ª£p l·ªá)
 * - [ ] X√°c th·ª±c input
 * - [ ] X·ª≠ l√Ω l·ªói
 * - [ ] T·ªëi ∆∞u hi·ªáu nƒÉng
 * - [ ] T√†i li·ªáu ho√° code
 * - [ ] C√°c k·ªãch b·∫£n unit test
 */

// ========================================
// SAMPLE DATA
// ========================================

const rawSalesData = [
  {
    date: "2024-01-01",
    product: "Laptop",
    quantity: 2,
    price: 1000,
    customer: "John Doe",
    region: "West",
  },
  {
    date: "2024-01-01",
    product: "Mouse",
    quantity: 5,
    price: 25,
    customer: "Jane Smith",
    region: "East",
  },
  {
    date: "2024-01-02",
    product: "Keyboard",
    quantity: 3,
    price: 75,
    customer: "Bob Johnson",
    region: "West",
  },
  {
    date: "2024-01-02",
    product: "Monitor",
    quantity: 1,
    price: 300,
    customer: "Alice Brown",
    region: "North",
  },
  {
    date: "2024-01-03",
    product: "Laptop",
    quantity: 1,
    price: 1000,
    customer: "Charlie Wilson",
    region: "South",
  },
  {
    date: "2024-01-03",
    product: "Mouse",
    quantity: 10,
    price: 25,
    customer: "Diana Moore",
    region: "East",
  },
  // C√°c b·∫£n ghi kh√¥ng h·ª£p l·ªá ƒë·ªÉ ki·ªÉm th·ª≠
  {
    date: null,
    product: "Cable",
    quantity: -5,
    price: 15,
    customer: "",
    region: "West",
  },
  {
    date: "2024-01-04",
    product: "",
    quantity: 0,
    price: 0,
    customer: "Test",
    region: "",
  },
];

// ========================================
// TODO: IMPLEMENT THE SYSTEM
// ========================================

/**
 * Class 1: DataImporter
 * Responsibility: Import v√† normalize data t·ª´ nhi·ªÅu ngu·ªìn
 */
class DataImporter {
  // Import t·ª´ array
  importFromArray(data) {
    // YOUR CODE HERE
    // - Validate input is array
    // - Normalize field names (lowercase, trim)
    // - Return normalized data
  }

  // Import t·ª´ CSV string (bonus)
  importFromCSV(csvString) {
    // YOUR CODE HERE
    // - Parse CSV
    // - Convert to array of objects
    // - Normalize
  }
}

/**
 * Class 2: DataValidator
 * Responsibility: Validate v√† clean data
 */
class DataValidator {
  constructor() {
    this.validationErrors = [];
  }

  // Validate single record
  validateRecord(record) {
    // YOUR CODE HERE
    // Rules:
    // - date: required, valid date format
    // - product: required, non-empty string
    // - quantity: required, positive number
    // - price: required, positive number
    // - customer: required, non-empty string
    // - region: required, one of [North, South, East, West]
    // Return: { isValid: boolean, errors: [] }
  }

  // Validate all records
  validateAll(data) {
    // YOUR CODE HERE
    // - Validate each record
    // - Collect all errors
    // - Return: { validRecords: [], invalidRecords: [], errors: [] }
  }

  // Clean data - remove invalid, fill defaults
  clean(data, options = {}) {
    // YOUR CODE HERE
    // options: { removeInvalid: true, fillDefaults: false }
  }
}

/**
 * Class 3: DataTransformer
 * Responsibility: Transform v√† enrich data
 */
class DataTransformer {
  // Add calculated fields
  addCalculatedFields(data) {
    // YOUR CODE HERE
    // Add fields:
    // - revenue: quantity * price
    // - date: convert to Date object
    // - month: extract month
    // - dayOfWeek: extract day of week
  }

  // Group by key
  groupBy(data, key) {
    // YOUR CODE HERE
    // Return: { [key]: [...records] }
  }

  // Aggregate data
  aggregate(data, groupKey, aggregations) {
    // YOUR CODE HERE
    // Example aggregations:
    // { sum: 'revenue', avg: 'price', count: '*' }
  }
}

/**
 * Class 4: AnalyticsEngine
 * Responsibility: Calculate metrics v√† insights
 */
class AnalyticsEngine {
  constructor(data) {
    this.data = data;
  }

  // Calculate total revenue
  getTotalRevenue() {
    // YOUR CODE HERE
  }

  // Calculate revenue by product
  getRevenueByProduct() {
    // YOUR CODE HERE
    // Return: { product: revenue }
  }

  // Calculate revenue by region
  getRevenueByRegion() {
    // YOUR CODE HERE
  }

  // Calculate revenue by date
  getRevenueByDate() {
    // YOUR CODE HERE
  }

  // Get top products
  getTopProducts(n = 5) {
    // YOUR CODE HERE
    // Return: [{ product, revenue }] sorted by revenue
  }

  // Get top customers
  getTopCustomers(n = 5) {
    // YOUR CODE HERE
  }

  // Get sales trends
  getSalesTrends() {
    // YOUR CODE HERE
    // Return: { dailyAverage, trend: 'up'|'down'|'stable' }
  }

  // Calculate conversion metrics
  getMetrics() {
    // YOUR CODE HERE
    // Return: {
    //   totalRevenue,
    //   totalOrders,
    //   averageOrderValue,
    //   topProduct,
    //   topRegion
    // }
  }
}

/**
 * Class 5: ReportGenerator
 * Responsibility: Generate formatted reports
 */
class ReportGenerator {
  constructor(analyticsEngine) {
    this.analytics = analyticsEngine;
  }

  // Generate summary report
  generateSummary() {
    // YOUR CODE HERE
    // Return formatted string
  }

  // Generate detailed report
  generateDetailedReport() {
    // YOUR CODE HERE
  }

  // Export to JSON
  exportToJSON() {
    // YOUR CODE HERE
  }

  // Export to CSV
  exportToCSV() {
    // YOUR CODE HERE
  }
}

// ========================================
// MAIN PIPELINE
// ========================================

/**
 * Main function - orchestrate the entire pipeline
 */
function processSalesData(rawData) {
  console.log("=== Sales Analytics Pipeline ===\n");

  // Step 1: Import
  console.log("Step 1: Importing data...");
  const importer = new DataImporter();
  const imported = importer.importFromArray(rawData);
  console.log(`Imported ${imported.length} records\n`);

  // Step 2: Validate
  console.log("Step 2: Validating data...");
  const validator = new DataValidator();
  const validation = validator.validateAll(imported);
  console.log(`Valid: ${validation.validRecords.length}`);
  console.log(`Invalid: ${validation.invalidRecords.length}`);
  if (validation.errors.length > 0) {
    console.log("Errors:", validation.errors.slice(0, 3), "...\n");
  }

  // Step 3: Clean
  console.log("Step 3: Cleaning data...");
  const cleaned = validator.clean(imported, { removeInvalid: true });
  console.log(`Cleaned: ${cleaned.length} records\n`);

  // Step 4: Transform
  console.log("Step 4: Transforming data...");
  const transformer = new DataTransformer();
  const transformed = transformer.addCalculatedFields(cleaned);
  console.log("Added calculated fields\n");

  // Step 5: Analyze
  console.log("Step 5: Analyzing data...");
  const analytics = new AnalyticsEngine(transformed);
  const metrics = analytics.getMetrics();
  console.log("Metrics:", metrics, "\n");

  // Step 6: Report
  console.log("Step 6: Generating reports...");
  const reporter = new ReportGenerator(analytics);
  const summary = reporter.generateSummary();
  console.log(summary);

  return {
    rawCount: rawData.length,
    validCount: cleaned.length,
    metrics,
    reports: {
      summary,
      detailed: reporter.generateDetailedReport(),
    },
  };
}

// Run pipeline
const result = processSalesData(rawSalesData);

// ========================================
// üìù DOCUMENTATION
// ========================================

/**
 * README.md
 *
 * # Sales Analytics Pipeline
 *
 * ## T√≠nh nƒÉng
 * - Import d·ªØ li·ªáu t·ª´ nhi·ªÅu ngu·ªìn
 * - X√°c th·ª±c v√† l√†m s·∫°ch d·ªØ li·ªáu
 * - Bi·∫øn ƒë·ªïi v√† l√†m gi√†u d·ªØ li·ªáu
 * - T√≠nh to√°n c√°c ch·ªâ s·ªë ph√¢n t√≠ch
 * - T·∫°o b√°o c√°o
 *
 * ## C√°ch s·ª≠ d·ª•ng
 * ```javascript
 * const result = processSalesData(rawData);
 * console.log(result.metrics);
 * ```
 *
 * ## T√†i li·ªáu API
 * [T√†i li·ªáu ho√° t·ª´ng class v√† method]
 *
 * ## Ghi ch√∫ v·ªÅ hi·ªáu nƒÉng
 * - X·ª≠ l√Ω hi·ªáu qu·∫£ l√™n ƒë·∫øn 10.000 b·∫£n ghi
 * - S·ª≠ d·ª•ng c√°c ph∆∞∆°ng th·ª©c array ph√π h·ª£p ƒë·ªÉ gi·∫£m s·ªë l·∫ßn l·∫∑p
 * - Cache c√°c gi√° tr·ªã ƒë√£ ƒë∆∞·ª£c t√≠nh to√°n
 *
 * ## X·ª≠ l√Ω l·ªói
 * - X√°c th·ª±c t·∫•t c·∫£ input
 * - Cung c·∫•p th√¥ng b√°o l·ªói chi ti·∫øt
 * - Tho√°i lui an to√†n (graceful degradation) khi d·ªØ li·ªáu kh√¥ng h·ª£p l·ªá
 */

// ========================================
// üîç CODE REVIEW SELF-CHECKLIST
// ========================================

/**
 * - [ ] T·∫•t c·∫£ class ƒë√£ ƒë∆∞·ª£c implement
 * - [ ] C√≥ validate input trong t·∫•t c·∫£ method
 * - [ ] X·ª≠ l√Ω l·ªói cho c√°c edge case
 * - [ ] S·ª≠ d·ª•ng ph∆∞∆°ng th·ª©c array ph√π h·ª£p
 * - [ ] ƒê√£ t·ªëi ∆∞u hi·ªáu nƒÉng (kh√¥ng c√≥ v√≤ng l·∫∑p d∆∞ th·ª´a)
 * - [ ] Code c√≥ t√†i li·ªáu ho√°
 * - [ ] T√™n bi·∫øn r√µ r√†ng, d·ªÖ hi·ªÉu
 * - [ ] Function thu·∫ßn (pure function) khi c√≥ th·ªÉ
 * - [ ] Kh√¥ng c√≥ side effect trong c√°c ph√©p t√≠nh
 * - [ ] Test pass v·ªõi c·∫£ d·ªØ li·ªáu h·ª£p l·ªá v√† kh√¥ng h·ª£p l·ªá
 */
````

<details>
  <summary>üí° Solution Sales Analytics Pipeline (Production-ready)</summary>

```javascript
/**
 * Sales Analytics Pipeline - Production-ready implementation
 * Features: Import ‚Üí Validate ‚Üí Clean ‚Üí Transform ‚Üí Analyze ‚Üí Report
 * Performance: Optimized with single-pass where possible, appropriate array methods
 * Error handling: Graceful, detailed errors, invalid data skipped or defaulted
 */

/**
 * DataImporter: Nh·∫≠p v√† chu·∫©n h√≥a d·ªØ li·ªáu t·ª´ nhi·ªÅu ngu·ªìn
 */
class DataImporter {
  /**
   * Import t·ª´ m·∫£ng object
   * @param {Array} data - Raw sales data
   * @returns {Array} Normalized records
   */
  importFromArray(data) {
    if (!Array.isArray(data)) {
      throw new Error('Input must be an array');
    }

    return data.map((record) => {
      const normalized = {};
      for (const [key, value] of Object.entries(record)) {
        const lowerKey = key.toLowerCase().trim();
        normalized[lowerKey] = typeof value === 'string' ? value.trim() : value;
      }
      return normalized;
    });
  }

  /**
   * Import t·ª´ chu·ªói CSV
   * @param {string} csvString - N·ªôi dung CSV (c√≥ header ·ªü d√≤ng ƒë·∫ßu)
   * @param {Object} [options] - T√πy ch·ªçn parse
   * @param {string} [options.delimiter=','] - D·∫•u ph√¢n c√°ch c·ªôt
   * @param {boolean} [options.skipEmptyLines=true] - B·ªè qua d√≤ng tr·ªëng
   * @returns {Array<Object>} M·∫£ng c√°c record ƒë√£ normalize (key lowercase)
   * @throws {Error} N·∫øu csvString kh√¥ng h·ª£p l·ªá
   */
  importFromCSV(csvString, options = {}) {
      if (typeof csvString !== 'string' || !csvString.trim()) {
        throw new Error('CSV input must be a non-empty string');
      }

      const {
        delimiter = ',',
        skipEmptyLines = true,
      } = options;

      // T√°ch th√†nh c√°c d√≤ng
      const lines = csvString.split(/\r?\n/);

      if (lines.length < 1) {
        throw new Error('CSV is empty - no header found');
      }

      // L·∫•y header t·ª´ d√≤ng ƒë·∫ßu ti√™n
      const headers = this.#parseCSVLine(lines[0], delimiter)
        .map(h => h.toLowerCase().trim().replace(/\s+/g, '_')); // snake_case cho key ƒë·∫πp h∆°n

      if (headers.length === 0) {
        throw new Error('No headers found in CSV');
      }

      const records = [];

      // B·∫Øt ƒë·∫ßu t·ª´ d√≤ng 1 (b·ªè header)
      for (let i = 1; i < lines.length; i++) {
        const line = lines[i].trim();

        // B·ªè qua d√≤ng tr·ªëng n·∫øu b·∫≠t t√πy ch·ªçn
        if (skipEmptyLines && !line) continue;

        const values = this.#parseCSVLine(line, delimiter);

        // N·∫øu s·ªë c·ªôt kh√¥ng kh·ªõp header ‚Üí log warning nh∆∞ng v·∫´n x·ª≠ l√Ω (graceful)
        if (values.length !== headers.length) {
          console.warn(`Row ${i + 1} has mismatched columns (${values.length} vs ${headers.length})`);
          continue; // ho·∫∑c c√≥ th·ªÉ fill missing b·∫±ng undefined
        }

        const record = {};
        headers.forEach((header, idx) => {
          let value = values[idx]?.trim();

          // C·ªë g·∫Øng convert s·ªë n·∫øu c√≥ th·ªÉ
          if (value !== '' && !isNaN(value) && !isNaN(parseFloat(value))) {
            value = parseFloat(value);
          }

          record[header] = value;
        });

        records.push(record);
      }

      console.log(`Imported ${records.length} records from CSV`);

      return records;
    }

    /**
     * Helper: Parse m·ªôt d√≤ng CSV, h·ªó tr·ª£ gi√° tr·ªã c√≥ d·∫•u ngo·∫∑c k√©p
     * @private
     */
    #parseCSVLine(line, delimiter) {
      const result = [];
      let current = '';
      let inQuotes = false;

      for (let i = 0; i < line.length; i++) {
        const char = line[i];

        if (char === '"') {
          inQuotes = !inQuotes;
          continue;
        }

        if (char === delimiter && !inQuotes) {
          result.push(current);
          current = '';
          continue;
        }

        current += char;
      }

      // Push ph·∫ßn cu·ªëi
        result.push(current);
      // V√¨ v√≤ng for ch·ªâ push khi g·∫∑p delimiter,
      // nh∆∞ng gi√° tr·ªã cu·ªëi c√πng KH√îNG c√≥ delimiter ph√≠a sau.
      // N·∫øu kh√¥ng push ·ªü cu·ªëi ‚Üí m·∫•t c·ªôt cu·ªëi c√πng.


      return result;
    }
    // ========================================
    // V√≠ d·ª• s·ª≠ d·ª•ng
    // ========================================

    const sampleCSV = `
    date,product,quantity,price,customer,region
    2024-01-01,Laptop,2,1000,John Doe,West
    2024-01-01,Mouse,5,25,Jane Smith,East
    "2024-01-02","Keyboard, Pro",3,75,Bob Johnson,West
    2024-01-02,Monitor,1,300,Alice Brown,North
    `;

    const importer = new DataImporter();
    const csvData = importer.importFromCSV(sampleCSV);

    console.log(csvData[0]);
    // ‚Üí { date: '2024-01-01', product: 'Laptop', quantity: 2, price: 1000, customer: 'John Doe', region: 'West' }
  }

/**
 * DataValidator: Ki·ªÉm tra v√† l√†m s·∫°ch d·ªØ li·ªáu
 */
class DataValidator {
  constructor() {
    this.validationErrors = [];
  }

  /**
   * Validate m·ªôt record
   * @returns {{isValid: boolean, errors: string[]}}
   */
  validateRecord(record) {
    const errors = [];

    // date: required, valid ISO date
    if (!record.date || isNaN(Date.parse(record.date))) {
      errors.push('Invalid or missing date');
    }

    // product: required, non-empty
    if (
      !record.product ||
      typeof record.product !== 'string' ||
      record.product.trim() === ''
    ) {
      errors.push('Invalid or missing product name');
    }

    // quantity: positive integer
    if (
      typeof record.quantity !== 'number' ||
      !Number.isInteger(record.quantity) ||
      record.quantity <= 0
    ) {
      errors.push('Quantity must be positive integer');
    }

    // price: positive number
    if (
      typeof record.price !== 'number' ||
      record.price <= 0 ||
      !Number.isFinite(record.price)
    ) {
      errors.push('Price must be positive number');
    }

    // customer: required, non-empty
    if (
      !record.customer ||
      typeof record.customer !== 'string' ||
      record.customer.trim() === ''
    ) {
      errors.push('Invalid or missing customer name');
    }

    // region: required, one of allowed values
    const validRegions = ['north', 'south', 'east', 'west'];
    if (!record.region || !validRegions.includes(record.region.toLowerCase())) {
      errors.push(`Region must be one of: ${validRegions.join(', ')}`);
    }

    return {
      isValid: errors.length === 0,
      errors,
    };
  }

  /**
   * Validate to√†n b·ªô dataset
   */
  validateAll(data) {
    this.validationErrors = [];
    const validRecords = [];
    const invalidRecords = [];

    data.forEach((record, index) => {
      const { isValid, errors } = this.validateRecord(record);
      if (isValid) {
        validRecords.push(record);
      } else {
        invalidRecords.push(record);
        this.validationErrors.push({
          index,
          record,
          errors,
        });
      }
    });

    return {
      validRecords,
      invalidRecords,
      errors: this.validationErrors,
    };
  }

  /**
   * Clean data: lo·∫°i b·ªè invalid ho·∫∑c fill default t√πy options
   */
  clean(data, options = { removeInvalid: true, fillDefaults: false }) {
    if (options.removeInvalid) {
      const validation = this.validateAll(data);
      return validation.validRecords;
    }

    // N·∫øu kh√¥ng remove, c√≥ th·ªÉ fill default (ch∆∞a implement chi ti·∫øt ·ªü ƒë√¢y)
    return data;
  }
}

/**
 * DataTransformer: Bi·∫øn ƒë·ªïi v√† enrich data
 */
class DataTransformer {
  /**
   * Th√™m c√°c tr∆∞·ªùng t√≠nh to√°n
   * @returns {Array} data v·ªõi c√°c field m·ªõi
   */
  addCalculatedFields(data) {
    return data.map((record) => {
      const dateObj = new Date(record.date);
      return {
        ...record,
        revenue: record.quantity * record.price,
        dateObj,
        month: dateObj.getMonth() + 1, // 1-12
        dayOfWeek: dateObj.toLocaleString('en-US', { weekday: 'short' }),
      };
    });
  }

  /**
   * Group by key
   */
  groupBy(data, key) {
    return data.reduce((acc, item) => {
      const groupKey = item[key];
      if (!acc[groupKey]) acc[groupKey] = [];
      acc[groupKey].push(item);
      return acc;
    }, {});
  }

  /**
   * Aggregate theo groupKey v·ªõi c√°c ph√©p t√≠nh
   */
  aggregate(data, groupKey, aggregations = {}) {
    const groups = this.groupBy(data, groupKey);

    return Object.fromEntries(
      Object.entries(groups).map(([key, items]) => {
        const result = { [groupKey]: key, count: items.length };

        if (aggregations.sum) {
          result[`sum_${aggregations.sum}`] = items.reduce(
            (sum, i) => sum + (i[aggregations.sum] || 0),
            0
          );
        }
        if (aggregations.avg) {
          const total = items.reduce(
            (sum, i) => sum + (i[aggregations.avg] || 0),
            0
          );
          result[`avg_${aggregations.avg}`] = items.length
            ? total / items.length
            : 0;
        }

        return [key, result];
      })
    );
  }
}

/**
 * AnalyticsEngine: T√≠nh to√°n c√°c ch·ªâ s·ªë kinh doanh
 */
class AnalyticsEngine {
  constructor(data) {
    this.data = data;
  }

  getTotalRevenue() {
    return this.data.reduce((sum, r) => sum + r.revenue, 0);
  }

  getRevenueByProduct() {
    const grouped = new DataTransformer().groupBy(this.data, 'product');
    return Object.fromEntries(
      Object.entries(grouped).map(([product, items]) => [
        product,
        items.reduce((sum, i) => sum + i.revenue, 0),
      ])
    );
  }

  getRevenueByRegion() {
    const grouped = new DataTransformer().groupBy(this.data, 'region');
    return Object.fromEntries(
      Object.entries(grouped).map(([region, items]) => [
        region,
        items.reduce((sum, i) => sum + i.revenue, 0),
      ])
    );
  }

  getTopProducts(n = 5) {
    const revenueByProduct = this.getRevenueByProduct();
    return Object.entries(revenueByProduct)
      .map(([product, revenue]) => ({ product, revenue }))
      .sort((a, b) => b.revenue - a.revenue)
      .slice(0, n);
  }

  getMetrics() {
    const totalRevenue = this.getTotalRevenue();
    const totalOrders = this.data.length;
    const averageOrderValue = totalOrders ? totalRevenue / totalOrders : 0;

    const revenueByProduct = this.getRevenueByProduct();
    const topProduct = Object.entries(revenueByProduct).reduce(
      (max, [p, rev]) =>
        rev > max.revenue ? { product: p, revenue: rev } : max,
      { revenue: -Infinity }
    );

    const revenueByRegion = this.getRevenueByRegion();
    const topRegion = Object.entries(revenueByRegion).reduce(
      (max, [r, rev]) =>
        rev > max.revenue ? { region: r, revenue: rev } : max,
      { revenue: -Infinity }
    );

    return {
      totalRevenue,
      totalOrders,
      averageOrderValue: Number(averageOrderValue.toFixed(2)),
      topProduct,
      topRegion,
    };
  }
}

/**
 * ReportGenerator: T·∫°o b√°o c√°o ƒë·ªãnh d·∫°ng
 */
class ReportGenerator {
  constructor(analytics) {
    this.analytics = analytics;
  }

  generateSummary() {
    const m = this.analytics.getMetrics();
    return `
=== Sales Analytics Summary ===
Total Revenue     : $${m.totalRevenue.toLocaleString()}
Total Orders      : ${m.totalOrders}
Avg Order Value   : $${m.averageOrderValue}
Top Product       : ${
      m.topProduct.product
    } ($${m.topProduct.revenue.toLocaleString()})
Top Region        : ${
      m.topRegion.region
    } ($${m.topRegion.revenue.toLocaleString()})
    `.trim();
  }

  exportToJSON() {
    return JSON.stringify(this.analytics.getMetrics(), null, 2);
  }
}

/**
 * Main pipeline orchestration
 */
function processSalesData(rawData) {
  console.log('=== Sales Analytics Pipeline ===\n');

  // 1. Import
  const importer = new DataImporter();
  const imported = importer.importFromArray(rawData);
  console.log(`Imported ${imported.length} records`);

  // 2. Validate & Clean
  const validator = new DataValidator();
  const validation = validator.validateAll(imported);
  console.log(
    `Valid: ${validation.validRecords.length} | Invalid: ${validation.invalidRecords.length}`
  );

  const cleaned = validator.clean(imported, { removeInvalid: true });
  console.log(`After cleaning: ${cleaned.length} records\n`);

  // 3. Transform
  const transformer = new DataTransformer();
  const transformed = transformer.addCalculatedFields(cleaned);
  console.log(
    'Transform completed (added revenue, dateObj, month, dayOfWeek)\n'
  );

  // 4. Analyze
  const analytics = new AnalyticsEngine(transformed);
  const metrics = analytics.getMetrics();
  console.log('Key Metrics:', metrics, '\n');

  // 5. Report
  const reporter = new ReportGenerator(analytics);
  const summary = reporter.generateSummary();
  console.log(summary);

  return {
    rawCount: rawData.length,
    validCount: cleaned.length,
    invalidCount: validation.invalidRecords.length,
    metrics,
    summaryReport: summary,
  };
}

// Ch·∫°y th·ª≠
const result = processSalesData(rawSalesData);

/*Gi·∫£i ph√°p n√†y:
 * - ƒê√°p ·ª©ng ƒë·∫ßy ƒë·ªß 5 class theo thi·∫øt k·∫ø
 * - X·ª≠ l√Ω validation nghi√™m ng·∫∑t, clean d·ªØ li·ªáu invalid
 * - T·ªëi ∆∞u performance: s·ª≠ d·ª•ng reduce/groupBy hi·ªáu qu·∫£, tr√°nh l·∫∑p th·ª´a
 * - C√≥ error handling c∆° b·∫£n + logging r√µ r√†ng
 * - D·ªÖ m·ªü r·ªông (CSV, th√™m metrics, cache, etc.)
 */
```

</details>

## üìä PH·∫¶N 4: SO S√ÅNH PATTERNS (30 ph√∫t)

### B·∫£ng So S√°nh Trade-offs

#### 1. Promises vs Callbacks vs async/await

| Aspect              | Callbacks                   | Promises                              | async/await                       |
| ------------------- | --------------------------- | ------------------------------------- | --------------------------------- |
| **Readability**     | ‚≠ê (Pyramid of doom)        | ‚≠ê‚≠ê‚≠ê (Chainable)                    | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (Sequential)           |
| **Error Handling**  | ‚≠ê (Try-catch m·ªói callback) | ‚≠ê‚≠ê‚≠ê (Centralized .catch)           | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (Try-catch block)      |
| **Debugging**       | ‚≠ê (Kh√≥ trace)              | ‚≠ê‚≠ê‚≠ê (Better stack traces)          | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (Linear execution)     |
| **Learning Curve**  | ‚≠ê‚≠ê (Simple concept)       | ‚≠ê‚≠ê‚≠ê‚≠ê (Need to understand Promise) | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (Easiest once learned) |
| **Browser Support** | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (All)            | ‚≠ê‚≠ê‚≠ê‚≠ê (IE11+)                      | ‚≠ê‚≠ê‚≠ê‚≠ê (Modern browsers)        |
| **Use Case**        | Legacy code                 | Modern async code                     | Preferred for new code            |

**When to use:**

- **Callbacks**: ‚ùå Avoid (legacy support only)
- **Promises**: ‚úÖ When need fine-grained control, chaining
- **async/await**: ‚úÖ Default choice (clearest code)

#### 2. Default Export vs Named Export

| Aspect               | Default Export                 | Named Export                      |
| -------------------- | ------------------------------ | --------------------------------- |
| **Naming Freedom**   | ‚úÖ Import with any name        | ‚ùå Must use exact name (or alias) |
| **Import Syntax**    | `import User from './User'`    | `import { User } from './User'`   |
| **Multiple Exports** | ‚ùå Only 1 per file             | ‚úÖ Multiple per file              |
| **Refactoring**      | ‚ùå Harder (name can vary)      | ‚úÖ Easier (consistent names)      |
| **Tree Shaking**     | ‚≠ê‚≠ê‚≠ê                         | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (Better)               |
| **Use Case**         | Main export (component, class) | Utilities, constants              |

**Best Practices:**

```javascript
// ‚úÖ GOOD: Clear, predictable
// Button.js
export default function Button() {} // Main component

// utils.js
export function formatDate() {} // Utility
export function formatCurrency() {}

// ‚ùå AVOID: Confusing
// SomeFile.js
export default { a, b, c }; // What is the main thing?
```

#### 3. Optional Chaining (?.) vs Traditional Checks

| Aspect              | Traditional                  | Optional Chaining                |
| ------------------- | ---------------------------- | -------------------------------- |
| **Code Length**     | ‚ùå Very verbose              | ‚úÖ Concise                       |
| **Readability**     | ‚≠ê‚≠ê                         | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê                       |
| **Performance**     | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (Slightly faster) | ‚≠ê‚≠ê‚≠ê‚≠ê (Negligible difference) |
| **Browser Support** | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (All)             | ‚≠ê‚≠ê‚≠ê‚≠ê (ES2020+)               |
| **Maintenance**     | ‚ùå Error-prone               | ‚úÖ Safer                         |

```javascript
// Traditional
if (user && user.profile && user.profile.address) {
  const city = user.profile.address.city;
}

// Optional Chaining
const city = user?.profile?.address?.city;
```

#### 4. Nullish Coalescing (??) vs OR (||)

| Value       | `\|\|` Result | `??` Result |
| ----------- | ------------- | ----------- |
| `null`      | 'default'     | 'default'   |
| `undefined` | 'default'     | 'default'   |
| `false`     | 'default' ‚ùå  | `false` ‚úÖ  |
| `0`         | 'default' ‚ùå  | `0` ‚úÖ      |
| `''`        | 'default' ‚ùå  | `''` ‚úÖ     |
| `'value'`   | 'value'       | 'value'     |

**Decision Rule:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Need default value?             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚îú‚îÄ Want to keep 0, false, '' as valid?
         ‚îÇ  ‚Üí Use ?? (Nullish Coalescing)
         ‚îÇ
         ‚îî‚îÄ Want to replace ALL falsy values?
            ‚Üí Use || (OR operator)
```

---

### Decision Tree: Ch·ªçn Array Method

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ C·∫ßn x·ª≠ l√Ω array nh∆∞ th·∫ø n√†o?            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚îú‚îÄ T√¨m 1 element?
         ‚îÇ  ‚îú‚îÄ Tr·∫£ v·ªÅ element ‚Üí find()
         ‚îÇ  ‚îî‚îÄ Tr·∫£ v·ªÅ index ‚Üí findIndex()
         ‚îÇ
         ‚îú‚îÄ Check ƒëi·ªÅu ki·ªán?
         ‚îÇ  ‚îú‚îÄ Check √çT NH·∫§T 1 ‚Üí some()
         ‚îÇ  ‚îî‚îÄ Check T·∫§T C·∫¢ ‚Üí every()
         ‚îÇ
         ‚îú‚îÄ L·ªçc elements?
         ‚îÇ  ‚îú‚îÄ L·∫•y 1 element ‚Üí find()
         ‚îÇ  ‚îî‚îÄ L·∫•y nhi·ªÅu elements ‚Üí filter()
         ‚îÇ
         ‚îú‚îÄ Transform array?
         ‚îÇ  ‚îú‚îÄ 1-1 mapping ‚Üí map()
         ‚îÇ  ‚îú‚îÄ Flatten array ‚Üí flatMap()
         ‚îÇ  ‚îî‚îÄ Combine to 1 value ‚Üí reduce()
         ‚îÇ
         ‚îî‚îÄ Loop m√† kh√¥ng return?
            ‚Üí forEach()
```

**Performance Tips:**

| Operation           | ‚ùå Avoid                         | ‚úÖ Prefer         |
| ------------------- | -------------------------------- | ----------------- |
| Find 1 element      | `filter()[0]`                    | `find()`          |
| Check existence     | `filter().length > 0`            | `some()`          |
| Validate all        | `filter().length === arr.length` | `every()`         |
| Multiple operations | Chain multiple loops             | Combine in 1 loop |

---

## üß™ PH·∫¶N 5: DEBUG LAB (20 ph√∫t)

### Bug 1: Promise Not Awaited

```javascript
// üêõ BUG: Function kh√¥ng ch·ªù Promise complete
async function fetchUserData(userId) {
  const user = fetchUser(userId); // ‚ùå Qu√™n await
  console.log(user.name); // ‚ùå Cannot read property 'name' of Promise
  return user;
}

// ‚ùì QUESTIONS:
// 1. T·∫°i sao `user.name` b·ªã undefined?
// 2. `user` l√† g√¨ ·ªü ƒë√¢y?
// 3. Fix nh∆∞ th·∫ø n√†o?

// ‚úÖ SOLUTION:
async function fetchUserDataFixed(userId) {
  const user = await fetchUser(userId); // ‚úÖ Th√™m await
  console.log(user.name); // ‚úÖ Works now
  return user;
}

// üéì LESSON:
// - async function KH√îNG T·ª∞ ƒê·ªòNG await
// - Ph·∫£i explicitly d√πng await keyword
// - Promise l√† object ƒë·∫∑c bi·ªát, kh√¥ng ph·∫£i data
// - Debug: Check typeof, log gi√° tr·ªã ƒë·ªÉ ph√°t hi·ªán Promise

// üõ°Ô∏è PREVENTION:
// - Lu√¥n await Promise trong async function
// - Use ESLint rule: @typescript-eslint/no-floating-promises
// - TypeScript s·∫Ω warn n·∫øu kh√¥ng await
```

### Bug 2: OR vs Nullish Coalescing

```javascript
// üêõ BUG: S·ª≠ d·ª•ng || thay v√¨ ??
const config = {
  port: 0, // ‚úÖ Port 0 is valid!
  debug: false, // ‚úÖ false is valid!
  retries: null, // ‚ùå Should use default
};

function getConfig(config) {
  return {
    port: config.port || 3000, // üêõ BUG: 0 ‚Üí 3000
    debug: config.debug || false, // üêõ BUG: false ‚Üí false (OK nh∆∞ng misleading)
    retries: config.retries || 3, // ‚úÖ null ‚Üí 3 (OK)
  };
}

console.log(getConfig(config));
// { port: 3000, debug: false, retries: 3 }
//   ‚ùå port should be 0!

// ‚ùì QUESTIONS:
// 1. T·∫°i sao port th√†nh 3000 thay v√¨ 0?
// 2. Khi n√†o n√™n d√πng || vs ??
// 3. false || false tr·∫£ v·ªÅ g√¨?

// ‚úÖ SOLUTION:
function getConfigFixed(config) {
  return {
    port: config.port ?? 3000, // ‚úÖ 0 ‚Üí 0
    debug: config.debug ?? false, // ‚úÖ false ‚Üí false
    retries: config.retries ?? 3, // ‚úÖ null ‚Üí 3
  };
}

console.log(getConfigFixed(config));
// { port: 0, debug: false, retries: 3 } ‚úÖ

// üéì LESSON:
// - || checks falsy (null, undefined, false, 0, '', NaN)
// - ?? checks nullish (null, undefined ONLY)
// - 0, false, '' are VALID values in many cases
// - Use ?? as default for object properties

// üõ°Ô∏è PREVENTION:
// - Default to ?? unless specifically want to replace falsy
// - Document when || is intentional
// - Consider if 0, false, '' are valid for the use case
```

### Bug 3: Optional Chaining with Function Calls

```javascript
// üêõ BUG: Incorrect optional chaining syntax
const user = {
  name: "John",
  getProfile: () => ({ bio: "Developer" }),
};

// ‚ùå WRONG: Optional chaining on property, not call
const bio1 = user.getProfile?.()?.bio; // Works, but...
const bio2 = user.getSettings?.()?.theme; // undefined (OK)
const bio3 = user?.getProfile()?.bio; // üêõ Will throw if getProfile doesn't exist

// ‚ùì QUESTIONS:
// 1. Kh√°c nhau gi·ªØa obj.method?.() v√† obj?.method()?
// 2. Khi n√†o n√™n d√πng c√°i n√†o?
// 3. bio3 s·∫Ω crash khi n√†o?

// ‚úÖ SOLUTION:
// RULE: ?. goes BEFORE ()
const bio1Fixed = user.getProfile?.()?.bio; // ‚úÖ Safe call
const bio2Fixed = user.getSettings?.()?.theme; // ‚úÖ Safe call
const bio3Fixed = user?.getProfile?.()?.bio; // ‚úÖ Safest

// üéì LESSON:
// Method call optional chaining:
// - obj.method?.() - Call if method exists
// - obj?.method() - Access obj, then call (WILL throw if method doesn't exist)
// - obj?.method?.() - Safest (check both obj and method)

// üõ°Ô∏è PREVENTION:
// - Always use ?. before () for optional method calls
// - Chain ?.  for nested optional access
// - Test with null/undefined objects
```

---

## ‚úÖ PH·∫¶N 6: T·ª∞ ƒê√ÅNH GI√Å (15 ph√∫t)

### Knowledge Check

```markdown
- [ ] T√¥i hi·ªÉu kh√°c nhau gi·ªØa Callback, Promise, v√† async/await
- [ ] T√¥i bi·∫øt khi n√†o d√πng default vs named export
- [ ] T√¥i c√≥ th·ªÉ gi·∫£i th√≠ch c√°ch ?. ho·∫°t ƒë·ªông
- [ ] T√¥i bi·∫øt kh√°c nhau gi·ªØa ?? v√† ||
- [ ] T√¥i bi·∫øt khi n√†o d√πng find() vs filter()
- [ ] T√¥i bi·∫øt khi n√†o d√πng some() vs every()
- [ ] T√¥i c√≥ th·ªÉ s·ª≠ d·ª•ng Object.keys/values/entries
- [ ] T√¥i hi·ªÉu performance implications c·ªßa array methods
- [ ] T√¥i c√≥ th·ªÉ handle nested data safely
- [ ] T√¥i bi·∫øt c√°ch debug Promise issues
```

### Code Review Checklist

```markdown
#### ES6 Modules

- [ ] Export type ph√π h·ª£p (default vs named)
- [ ] Import statements r√µ r√†ng
- [ ] Kh√¥ng c√≥ circular dependencies
- [ ] File structure logic

#### Async Code

- [ ] Promises ƒë∆∞·ª£c await ƒë√∫ng c√°ch
- [ ] Error handling v·ªõi try-catch
- [ ] Kh√¥ng c√≥ floating promises
- [ ] Appropriate use of Promise.all for parallel

#### Safe Access

- [ ] S·ª≠ d·ª•ng ?. cho nested access
- [ ] S·ª≠ d·ª•ng ?? cho defaults (not ||)
- [ ] Handle null/undefined cases
- [ ] Preserve valid falsy values (0, false, '')

#### Array Methods

- [ ] Ch·ªçn ƒë√∫ng method cho use case
- [ ] Kh√¥ng c√≥ unnecessary iterations
- [ ] Early termination khi c√≥ th·ªÉ (some, every, find)
- [ ] Pure functions (no mutations)

#### General

- [ ] Code readable and maintainable
- [ ] Edge cases handled
- [ ] Variables named clearly
- [ ] Comments cho complex logic
```

---

## üè† B√ÄI T·∫¨P V·ªÄ NH√Ä

### B·∫Øt bu·ªôc (30 ph√∫t)

**B√†i 1: Promise Chain Practice**

```javascript
/**
 * T·∫°o m·ªôt series of promises simulate multi-step process:
 * 1. validateUser(userId) - Check user h·ª£p l·ªá
 * 2. fetchUserPermissions(userId) - L·∫•y permissions
 * 3. checkAccess(permissions, resource) - Check c√≥ quy·ªÅn kh√¥ng
 *
 * Requirements:
 * - Chain promises properly
 * - Handle errors at each step
 * - Return final result
 */
```

<details>
  <summary>üí° Solution</summary>

```javascript
/**
 * B√†i 1: Promise Chain Practice - Multi-step User Access Check
 * M√¥ ph·ªèng quy tr√¨nh ki·ªÉm tra quy·ªÅn truy c·∫≠p theo th·ª© t·ª±:
 * 1. Validate user
 * 2. L·∫•y permissions
 * 3. Ki·ªÉm tra quy·ªÅn truy c·∫≠p resource
 *
 * Y√™u c·∫ßu:
 * - Chain promise ƒë√∫ng c√°ch (.then / .catch)
 * - X·ª≠ l√Ω l·ªói ·ªü t·ª´ng b∆∞·ªõc
 * - Tr·∫£ v·ªÅ k·∫øt qu·∫£ cu·ªëi c√πng ho·∫∑c throw error
 */

// H√†m gi·∫£ l·∫≠p (simulate async operations)
function validateUser(userId) {
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      if (!userId || typeof userId !== "string" || userId.trim() === "") {
        reject(new Error("Invalid userId: must be a non-empty string"));
      } else if (userId === "invalid_user") {
        reject(new Error("User not found or banned"));
      } else {
        console.log(`User ${userId} validated`);
        resolve({ userId, status: "active" });
      }
    }, 800);
  });
}

function fetchUserPermissions(userId) {
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      // Gi·∫£ l·∫≠p l·∫•y permissions t·ª´ DB/API
      const permissionsDb = {
        user123: ["read:profile", "write:posts", "delete:own"],
        admin001: ["read:*", "write:*", "delete:*", "manage:users"],
        guest999: ["read:public"],
      };

      const perms = permissionsDb[userId];
      if (!perms) {
        reject(new Error("No permissions found for this user"));
      } else {
        console.log(`Permissions loaded for ${userId}`);
        resolve(perms);
      }
    }, 600);
  });
}

function checkAccess(permissions, resource) {
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      // resource v√≠ d·ª•: 'posts:edit', 'users:delete', 'profile:read'
      const requiredPerm = resource.split(":")[0] + ":*"; // wildcard check
      const hasAccess =
        permissions.includes(resource) ||
        permissions.includes(requiredPerm) ||
        permissions.includes("admin:*");

      if (hasAccess) {
        console.log(`Access granted to ${resource}`);
        resolve({ granted: true, resource });
      } else {
        reject(new Error(`Access denied to ${resource}`));
      }
    }, 400);
  });
}

/**
 * H√†m ch√≠nh: checkUserAccess
 * Chain to√†n b·ªô quy tr√¨nh v√† x·ª≠ l√Ω l·ªói t·∫≠p trung
 * @param {string} userId
 * @param {string} resource - v√≠ d·ª•: 'posts:edit'
 * @returns {Promise<{granted: boolean, resource: string}>}
 */
function checkUserAccess(userId, resource) {
  console.log(`\n=== Checking access for user: ${userId} to ${resource} ===`);

  return validateUser(userId)
    .then((user) => {
      // B∆∞·ªõc 1 th√†nh c√¥ng ‚Üí l·∫•y permissions
      return fetchUserPermissions(user.userId);
    })
    .then((permissions) => {
      // B∆∞·ªõc 2 th√†nh c√¥ng ‚Üí check quy·ªÅn
      return checkAccess(permissions, resource);
    })
    .then((result) => {
      // Th√†nh c√¥ng to√†n b·ªô
      console.log("Final result: Access granted ‚úì");
      return result;
    })
    .catch((error) => {
      // X·ª≠ l√Ω l·ªói t·∫≠p trung
      console.error("Access check failed:", error.message);
      throw error; // n√©m ti·∫øp ƒë·ªÉ caller x·ª≠ l√Ω n·∫øu c·∫ßn
    });
}

// ========================================
// TEST CASES
// ========================================

// Test 1: Th√†nh c√¥ng
checkUserAccess("user123", "posts:edit")
  .then((result) => console.log("Result:", result))
  .catch((err) => console.log("Caught:", err.message));

// Test 2: User kh√¥ng t·ªìn t·∫°i
checkUserAccess("invalid_user", "profile:read").catch((err) =>
  console.log("Expected error:", err.message),
);

// Test 3: Kh√¥ng c√≥ quy·ªÅn
checkUserAccess("guest999", "posts:delete").catch((err) =>
  console.log("Expected denied:", err.message),
);

// Test 4: Admin full quy·ªÅn
checkUserAccess("admin001", "users:delete").then((result) =>
  console.log("Admin access:", result),
);

// Bonus: D√πng async/await (c√°ch vi·∫øt hi·ªán ƒë·∫°i h∆°n, d·ªÖ ƒë·ªçc)
async function checkUserAccessAsync(userId, resource) {
  try {
    const user = await validateUser(userId);
    const permissions = await fetchUserPermissions(user.userId);
    const access = await checkAccess(permissions, resource);
    console.log("Async success:", access);
    return access;
  } catch (error) {
    console.error("Async failed:", error.message);
    throw error;
  }
}

// Ch·∫°y th·ª≠ async version
// checkUserAccessAsync('user123', 'write:posts');
```

</details>

---

**B√†i 2: Module Organization**

```javascript
/**
 * Refactor code sau th√†nh module structure h·ª£p l√Ω:
 * - T·∫°o separate files cho utilities
 * - Use appropriate export types
 * - Re-export t·ª´ index
 */
```

<details>
<summary>üí° Solution</summary>

```javascript
/**
 * ========================================
 * üìÅ C·∫•u tr√∫c th∆∞ m·ª•c ƒë·ªÅ xu·∫•t
 * ========================================
 *
 * src/
 * ‚îú‚îÄ‚îÄ utils/
 * ‚îÇ   ‚îú‚îÄ‚îÄ validators.js // c√°c h√†m validate
 * ‚îÇ   ‚îî‚îÄ‚îÄ formatters.js // (n·∫øu c·∫ßn format sau n√†y)
 * ‚îú‚îÄ‚îÄ auth/
 * ‚îÇ   ‚îú‚îÄ‚îÄ validateUser.js
 * ‚îÇ   ‚îú‚îÄ‚îÄ fetchPermissions.js
 * ‚îÇ   ‚îî‚îÄ‚îÄ checkAccess.js
 * ‚îú‚îÄ‚îÄ accessChecker.js // h√†m ch√≠nh chain c√°c b∆∞·ªõc
 * ‚îî‚îÄ‚îÄ index.js // public API, re-export
 */
```

```javascript
/**
 * ========================================
 * 1. src/auth/validateUser.js
 * ========================================
 */

/**
 * Validate user ID
 *
 * @param {string} userId
 * @returns {Promise<{ userId: string, status: string }>}
 * @throws {Error}
 */
export async function validateUser(userId) {
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      if (!userId || typeof userId !== "string" || userId.trim() === "") {
        reject(new Error("Invalid userId: must be a non-empty string"));
      } else if (userId === "invalid_user") {
        reject(new Error("User not found or banned"));
      } else {
        console.log(`User ${userId} validated`);
        resolve({ userId, status: "active" });
      }
    }, 800);
  });
}
```

```javascript
/**
 * ========================================
 * 2. src/auth/fetchPermissions.js
 * ========================================
 */

/**
 * Fetch permissions for a user
 *
 * @param {string} userId
 * @returns {Promise<string[]>}
 * @throws {Error}
 */
export async function fetchUserPermissions(userId) {
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      const permissionsDb = {
        user123: ["read:profile", "write:posts", "delete:own"],
        admin001: ["read:*", "write:*", "delete:*", "manage:users"],
        guest999: ["read:public"],
      };

      const perms = permissionsDb[userId];
      if (!perms) {
        reject(new Error("No permissions found for this user"));
      } else {
        console.log(`Permissions loaded for ${userId}`);
        resolve(perms);
      }
    }, 600);
  });
}
```

```javascript
/**
 * ========================================
 * 3. src/auth/checkAccess.js
 * ========================================
 */

/**
 * Check if user has access to a resource
 *
 * @param {string[]} permissions
 * @param {string} resource
 * @returns {Promise<{ granted: boolean, resource: string }>}
 * @throws {Error}
 */
export async function checkAccess(permissions, resource) {
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      const requiredPerm = resource.split(":")[0] + ":*";

      const hasAccess =
        permissions.includes(resource) ||
        permissions.includes(requiredPerm) ||
        permissions.some((p) => p === "admin:*" || p === requiredPerm);

      if (hasAccess) {
        console.log(`Access granted to ${resource}`);
        resolve({ granted: true, resource });
      } else {
        reject(new Error(`Access denied to ${resource}`));
      }
    }, 400);
  });
}
```

```javascript
/**
 * ========================================
 * 4. src/accessChecker.js
 * (h√†m ch√≠nh ‚Äì orchestration)
 * ========================================
 */

import { validateUser } from "./auth/validateUser.js";
import { fetchUserPermissions } from "./auth/fetchPermissions.js";
import { checkAccess } from "./auth/checkAccess.js";

/**
 * Check user access to a resource through promise chain
 *
 * @param {string} userId
 * @param {string} resource
 * @returns {Promise<{ granted: boolean, resource: string }>}
 */
export async function checkUserAccess(userId, resource) {
  console.log(`\n=== Checking access for user: ${userId} to ${resource} ===`);

  try {
    const user = await validateUser(userId);
    const permissions = await fetchUserPermissions(user.userId);
    const accessResult = await checkAccess(permissions, resource);

    console.log("Final result: Access granted ‚úì");
    return accessResult;
  } catch (error) {
    console.error("Access check failed:", error.message);
    throw error;
  }
}

/**
 * Alternative: Promise chain style (n·∫øu kh√¥ng d√πng async/await)
 *
 * @param {string} userId
 * @param {string} resource
 * @returns {Promise<{ granted: boolean, resource: string }>}
 */
export function checkUserAccessPromise(userId, resource) {
  return validateUser(userId)
    .then((user) => fetchUserPermissions(user.userId))
    .then((permissions) => checkAccess(permissions, resource))
    .then((result) => {
      console.log("Final result: Access granted ‚úì");
      return result;
    })
    .catch((error) => {
      console.error("Access check failed:", error.message);
      throw error;
    });
}
```

```javascript
/**
 * ========================================
 * 5. src/index.js
 * (Re-export ‚Äì public API)
 * ========================================
 */

export { checkUserAccess, checkUserAccessPromise } from "./accessChecker.js";

// N·∫øu sau n√†y c√≥ th√™m util, export ·ªü ƒë√¢y
// export * from './utils/validators.js';
```

```javascript
/**
 * ========================================
 * C√°ch s·ª≠ d·ª•ng (v√≠ d·ª• trong file kh√°c)
 * ========================================
 *
 * // main.js ho·∫∑c test file
 */

import { checkUserAccess } from "./src/index.js";

async function test() {
  try {
    const result = await checkUserAccess("user123", "posts:edit");
    console.log("Result:", result);
  } catch (err) {
    console.log("Error:", err.message);
  }
}

test();
```

```javascript
/**
 * ========================================
 * L·ª£i √≠ch c·ªßa c·∫•u tr√∫c n√†y
 * ========================================
 *
 * - Single Responsibility: M·ªói file ch·ªâ l√†m 1 vi·ªác r√µ r√†ng
 * - D·ªÖ test: C√≥ th·ªÉ test ri√™ng t·ª´ng h√†m (validateUser, fetchPermissions, checkAccess)
 * - D·ªÖ m·ªü r·ªông: Th√™m b∆∞·ªõc m·ªõi (v√≠ d·ª•: logActivity, rateLimitCheck) ch·ªâ c·∫ßn import th√™m
 * - Re-export qua index: Caller ch·ªâ c·∫ßn import t·ª´ m·ªôt n∆°i duy nh·∫•t
 * - Tree-shaking friendly: Ch·ªâ bundle nh·ªØng g√¨ th·ª±c s·ª± d√πng
 * - Ph√π h·ª£p c·∫£ ESM & TypeScript (n·∫øu sau n√†y th√™m .ts th√¨ ch·ªâ c·∫ßn th√™m type)
 */
```

</details>

---

**B√†i 3: Safe Data Access**

```javascript
/**
 * Vi·∫øt function extractUserInfo(apiResponse) v·ªõi:
 * - Safe nested access
 * - Appropriate defaults
 * - Preserve valid falsy values
 */
```

<details>
  <summary>üí° Solution</summary>

```javascript
/**
 * Extract th√¥ng tin user t·ª´ API response m·ªôt c√°ch an to√†n
 * S·ª≠ d·ª•ng optional chaining (?.) v√† nullish coalescing (??)
 * ƒë·ªÉ tr√°nh l·ªói khi nested properties kh√¥ng t·ªìn t·∫°i
 *
 * Y√™u c·∫ßu:
 * - Kh√¥ng crash khi data thi·∫øu b·∫•t k·ª≥ c·∫•p n√†o
 * - Cung c·∫•p default h·ª£p l√Ω khi gi√° tr·ªã missing
 * - Gi·ªØ nguy√™n c√°c falsy values h·ª£p l·ªá (0, false, '', null)
 * - Code clean, d·ªÖ ƒë·ªçc, d·ªÖ m·ªü r·ªông
 *
 * @param {any} apiResponse - API response object (c√≥ th·ªÉ null/undefined)
 * @returns {Object} Th√¥ng tin user ƒë√£ ƒë∆∞·ª£c x·ª≠ l√Ω an to√†n
 */
function extractUserInfo(apiResponse) {
  // L·∫•y user m·ªôt c√°ch an to√†n ngay t·ª´ ƒë·∫ßu
  const user = apiResponse?.data?.user;

  // N·∫øu kh√¥ng c√≥ user ‚Üí tr·∫£ v·ªÅ to√†n b·ªô default
  if (!user) {
    return getDefaultUserInfo();
  }

  // L·∫•y c√°c ph·∫ßn nested an to√†n
  const profile = user.profile ?? {};
  const address = profile.address ?? {};
  const preferences = user.preferences ?? {};
  const stats = user.stats ?? {};

  return {
    // Basic info
    id: user.id ?? null,
    name: user.name ?? "Guest",
    email: user.email ?? "no-email@provided.com",
    username: user.username ?? "", // gi·ªØ '' n·∫øu c√≥

    // Profile
    avatar: profile.avatar ?? "/default-avatar.png",
    bio: profile.bio ?? "",
    joinedAt: profile.joinedAt ?? null,

    // Address (n·∫øu c√≥)
    location:
      address.city && address.country
        ? `${address.city}, ${address.country}`
        : "Not specified",

    // Preferences ‚Äì gi·ªØ falsy h·ª£p l·ªá (dark mode = false, notifications = 0)
    theme: preferences.theme ?? "light",
    notificationsEnabled: preferences.notifications?.enabled ?? true,
    emailNotifications: preferences.notifications?.email ?? false,

    // Stats ‚Äì gi·ªØ 0 n·∫øu c√≥
    stats: {
      posts: stats.posts ?? 0,
      followers: stats.followers ?? 0,
      following: stats.following ?? 0,
      reputation: stats.reputation ?? 0,
    },

    // Flags
    isVerified: user.isVerified ?? false,
    isAdmin: user.isAdmin ?? false,
    hasPremium: user.hasPremium ?? false,
  };
}

/**
 * Default user info khi kh√¥ng c√≥ data user
 * T√°ch ri√™ng ƒë·ªÉ d·ªÖ b·∫£o tr√¨
 */
function getDefaultUserInfo() {
  return {
    id: null,
    name: "Guest",
    email: "no-email@provided.com",
    username: "",
    avatar: "/default-avatar.png",
    bio: "",
    joinedAt: null,
    location: "Not specified",
    theme: "light",
    notificationsEnabled: true,
    emailNotifications: false,
    stats: {
      posts: 0,
      followers: 0,
      following: 0,
      reputation: 0,
    },
    isVerified: false,
    isAdmin: false,
    hasPremium: false,
  };
}

// ========================================
// V√≠ d·ª• s·ª≠ d·ª•ng & test cases
// ========================================

// Case 1: Full data
const fullResponse = {
  data: {
    user: {
      id: 123,
      name: "Tu√¢n L√™",
      email: "tuan@example.com",
      username: "tuan_dev",
      profile: {
        avatar: "https://example.com/avatar.jpg",
        bio: "Full-stack developer",
        joinedAt: "2023-05-15",
        address: {
          city: "Bi√™n H√≤a",
          country: "Vietnam",
        },
      },
      preferences: {
        theme: "dark",
        notifications: {
          enabled: true,
          email: false,
        },
      },
      stats: {
        posts: 42,
        followers: 1500,
        following: 320,
        reputation: 0, // falsy h·ª£p l·ªá
      },
      isVerified: true,
      isAdmin: false,
      hasPremium: true,
    },
  },
};

console.log(extractUserInfo(fullResponse));
// ‚Üí name: 'Tu√¢n L√™', theme: 'dark', reputation: 0, location: 'Bi√™n H√≤a, Vietnam', ...

// Case 2: Thi·∫øu nhi·ªÅu ph·∫ßn
const partialResponse = {
  data: {
    user: {
      id: 456,
      name: "",
      email: "user456@gmail.com",
    },
  },
};

console.log(extractUserInfo(partialResponse));
// ‚Üí name: 'Guest' (v√¨ name r·ªóng), avatar: default, theme: 'light', ...

// Case 3: Response l·ªói / null
console.log(extractUserInfo(null)); // ‚Üí full default
console.log(extractUserInfo({})); // ‚Üí full default
console.log(extractUserInfo({ data: {} })); // ‚Üí full default
```

**T·∫°i sao c√°ch n√†y t·ªët?**

- **An to√†n 100%**: Kh√¥ng bao gi·ªù throw TypeError do truy c·∫≠p nested undefined/null
- **Gi·ªØ falsy h·ª£p l·ªá**: `??` ch·ªâ fallback khi `null`/`undefined`, kh√¥ng ·∫£nh h∆∞·ªüng `0`, `false`, `''`
- **D·ªÖ ƒë·ªçc & b·∫£o tr√¨**: T√°ch default ri√™ng, c·∫•u tr√∫c return r√µ r√†ng theo nh√≥m
- **D·ªÖ m·ªü r·ªông**: Th√™m field m·ªõi ch·ªâ c·∫ßn th√™m d√≤ng t∆∞∆°ng ·ª©ng
- **Production-ready**: X·ª≠ l√Ω m·ªçi edge case ph·ªï bi·∫øn trong API response

N·∫øu API c√≥ c·∫•u tr√∫c kh√°c (v√≠ d·ª•: `apiResponse.user` thay v√¨ `apiResponse.data.user`), ch·ªâ c·∫ßn ƒëi·ªÅu ch·ªânh d√≤ng `const user = apiResponse?.data?.user;` l√† xong.

</details>

---

### N√¢ng cao (60 ph√∫t)

**B√†i 1: Async Data Pipeline**

```javascript
/**
 * X√¢y d·ª±ng pipeline x·ª≠ l√Ω data async:
 * 1. Fetch data t·ª´ multiple APIs (parallel)
 * 2. Combine results
 * 3. Transform data
 * 4. Cache results
 *
 * Use: Promise.all, async/await, proper error handling
 */
```

<details>
  <summary>üí° Solution</summary>

```javascript
/**
 * Async Data Pipeline - X·ª≠ l√Ω d·ªØ li·ªáu b·∫•t ƒë·ªìng b·ªô t·ª´ nhi·ªÅu ngu·ªìn
 *
 * M√¥ t·∫£ pipeline:
 * 1. Fetch song song t·ª´ nhi·ªÅu API (s·ª≠ d·ª•ng Promise.all)
 * 2. K·∫øt h·ª£p (combine) k·∫øt qu·∫£ t·ª´ c√°c ngu·ªìn
 * 3. Bi·∫øn ƒë·ªïi (transform) d·ªØ li·ªáu t·ªïng h·ª£p
 * 4. L∆∞u v√†o cache (in-memory ƒë∆°n gi·∫£n) ƒë·ªÉ t√°i s·ª≠ d·ª•ng
 *
 * @param {string[]} apiUrls - M·∫£ng c√°c URL API c·∫ßn g·ªçi
 * @param {Object} [options] - T√πy ch·ªçn pipeline
 * @param {number} [options.cacheTTL=300000] - Th·ªùi gian s·ªëng c·ªßa cache (ms) - m·∫∑c ƒë·ªãnh 5 ph√∫t
 * @param {boolean} [options.skipCache=false] - B·ªè qua cache v√† lu√¥n fetch m·ªõi
 * @returns {Promise<Object>} K·∫øt qu·∫£ ƒë√£ ƒë∆∞·ª£c x·ª≠ l√Ω v√† bi·∫øn ƒë·ªïi
 * @throws {AggregateError} N·∫øu c√≥ m·ªôt ho·∫∑c nhi·ªÅu request th·∫•t b·∫°i
 *
 * @example
 * const urls = [
 *   'https://api.example.com/users',
 *   'https://api.example.com/posts',
 *   'https://api.example.com/comments'
 * ];
 *
 * const result = await runAsyncDataPipeline(urls, { cacheTTL: 60000 });
 * console.log(result.combinedData);
 */
async function runAsyncDataPipeline(apiUrls, options = {}) {
  const {
    cacheTTL = 5 * 60 * 1000, // 5 ph√∫t
    skipCache = false,
  } = options;

  // Cache in-memory ƒë∆°n gi·∫£n (c√≥ th·ªÉ thay b·∫±ng Redis/Map v·ªõi TTL th·ª±c t·∫ø)
  /** @type {Map<string, { data: any, timestamp: number }>} */
  const cache = new Map();

  const cacheKey = apiUrls.sort().join("|"); // key d·ª±a tr√™n danh s√°ch URL ƒë√£ s·∫Øp x·∫øp

  // Ki·ªÉm tra cache
  if (!skipCache && cache.has(cacheKey)) {
    const cached = cache.get(cacheKey);
    if (Date.now() - cached.timestamp < cacheTTL) {
      console.log("Tr·∫£ v·ªÅ t·ª´ cache");
      return cached.data;
    }
  }

  try {
    // B∆∞·ªõc 1: Fetch song song t·ª´ t·∫•t c·∫£ API
    const responses = await Promise.all(
      apiUrls.map(async (url, index) => {
        try {
          const res = await fetch(url);
          if (!res.ok) {
            throw new Error(`HTTP ${res.status} t·ª´ ${url}`);
          }
          const data = await res.json();
          console.log(`API ${index + 1} (${url}) th√†nh c√¥ng`);
          return { url, data, success: true };
        } catch (err) {
          console.error(`API ${index + 1} (${url}) th·∫•t b·∫°i:`, err.message);
          return { url, error: err.message, success: false };
        }
      }),
    );

    // Ki·ªÉm tra xem c√≥ API n√†o th·∫•t b·∫°i kh√¥ng
    const failed = responses.filter((r) => !r.success);
    if (failed.length > 0) {
      throw new AggregateError(
        failed.map((f) => new Error(f.error)),
        `C√≥ ${failed.length} API th·∫•t b·∫°i`,
      );
    }

    // B∆∞·ªõc 2: K·∫øt h·ª£p k·∫øt qu·∫£
    const combinedData = responses.reduce((acc, { url, data }) => {
      const sourceName =
        new URL(url).pathname.split("/").pop() ||
        "source" + responses.indexOf({ url, data });
      acc[sourceName] = data;
      return acc;
    }, /** @type {Record<string, any>} */ ({}));

    // B∆∞·ªõc 3: Transform d·ªØ li·ªáu (v√≠ d·ª• minh h·ªça)
    const transformed = {
      timestamp: new Date().toISOString(),
      totalSources: responses.length,
      combined: combinedData,
      summary: {
        userCount: combinedData.users?.length || 0,
        postCount: combinedData.posts?.length || 0,
        commentCount: combinedData.comments?.length || 0,
      },
      // V√≠ d·ª• enrich th√™m metadata
      metadata: {
        processedAt: new Date(),
        sourceUrls: apiUrls,
      },
    };

    // B∆∞·ªõc 4: L∆∞u v√†o cache
    cache.set(cacheKey, {
      data: transformed,
      timestamp: Date.now(),
    });

    console.log("Pipeline ho√†n t·∫•t - d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c cache");
    return transformed;
  } catch (error) {
    console.error("Pipeline th·∫•t b·∫°i:", error);
    throw error;
  }
}

// ========================================
// V√≠ d·ª• s·ª≠ d·ª•ng
// ========================================

/**
 * @example
 * async function demo() {
 *   const urls = [
 *     'https://jsonplaceholder.typicode.com/users',
 *     'https://jsonplaceholder.typicode.com/posts',
 *     'https://jsonplaceholder.typicode.com/comments'
 *   ];
 *
 *   try {
 *     const result = await runAsyncDataPipeline(urls, { cacheTTL: 60000 });
 *     console.log('T·ªïng s·ªë user:', result.summary.userCount);
 *     console.log('T·ªïng s·ªë b√†i vi·∫øt:', result.summary.postCount);
 *   } catch (err) {
 *     console.error('L·ªói pipeline:', err);
 *   }
 * }
 *
 * demo();
 */
```

</details>

---

**B√†i 2: Advanced Array Operations**

```javascript
/**
 * Implement c√°c functions:
 * - groupBy(array, key) - Group array by property
 * - partition(array, predicate) - Split into [true, false]
 * - unique(array, key) - Remove duplicates
 * - sortByMultiple(array, keys) - Sort by multiple fields
 *
 * Requirements:
 * - Use appropriate array methods
 * - Optimize performance
 * - Handle edge cases
 */
```

<details>
  <summary>üí° Solution</summary>

```javascript
/**
 * Nh√≥m m·∫£ng c√°c object theo m·ªôt key (property) c·ª• th·ªÉ.
 * T·∫°o object v·ªõi key l√† gi√° tr·ªã c·ªßa property, value l√† m·∫£ng c√°c ph·∫ßn t·ª≠ t∆∞∆°ng ·ª©ng.
 *
 * @template T
 * @param {T[]} array - M·∫£ng c√°c object c·∫ßn nh√≥m
 * @param {string | ((item: T) => any)} key - T√™n property ho·∫∑c h√†m tr√≠ch xu·∫•t key
 * @returns {Record<string | number, T[]>} Object nh√≥m theo key
 *
 * @example
 * const users = [{ id: 1, role: 'admin' }, { id: 2, role: 'user' }, { id: 3, role: 'admin' }];
 * groupBy(users, 'role') // ‚Üí { admin: [{...}, {...}], user: [{...}] }
 */
export function groupBy(array, key) {
  if (!Array.isArray(array)) return {};

  const getKey = typeof key === "function" ? key : (item) => item?.[key];

  return array.reduce((acc, item) => {
    const groupKey = getKey(item);
    const group = acc[groupKey] || (acc[groupKey] = []);
    group.push(item);
    return acc;
  }, /** @type {Record<string | number, T[]>} */ ({}));
}

/**
 * Chia m·∫£ng th√†nh hai ph·∫ßn: ph·∫ßn t·ª≠ th·ªèa m√£n predicate v√† ph·∫ßn t·ª≠ kh√¥ng th·ªèa m√£n.
 *
 * @template T
 * @param {T[]} array - M·∫£ng ƒë·∫ßu v√†o
 * @param {(item: T) => boolean} predicate - H√†m ki·ªÉm tra ƒëi·ªÅu ki·ªán
 * @returns {[T[], T[]]} Tuple [ph·∫ßn t·ª≠ true, ph·∫ßn t·ª≠ false]
 *
 * @example
 * const numbers = [1, 2, 3, 4, 5];
 * partition(numbers, n => n % 2 === 0) // ‚Üí [[2,4], [1,3,5]]
 */
export function partition(array, predicate) {
  if (!Array.isArray(array)) return [[], []];

  return array.reduce(
    ([pass, fail], item) => {
      (predicate(item) ? pass : fail).push(item);
      return [pass, fail];
    },
    [[], []],
  );
}

/**
 * Lo·∫°i b·ªè c√°c ph·∫ßn t·ª≠ tr√πng l·∫∑p trong m·∫£ng, d·ª±a tr√™n key ho·∫∑c to√†n b·ªô object.
 * Gi·ªØ l·∫°i ph·∫ßn t·ª≠ xu·∫•t hi·ªán ƒë·∫ßu ti√™n.
 *
 * @template T
 * @param {T[]} array - M·∫£ng ƒë·∫ßu v√†o
 * @param {string | ((item: T) => any)} [key] - Property ho·∫∑c h√†m t·∫°o key duy nh·∫•t (n·∫øu kh√¥ng truy·ªÅn th√¨ so s√°nh to√†n b·ªô object)
 * @returns {T[]} M·∫£ng ƒë√£ lo·∫°i b·ªè tr√πng l·∫∑p
 *
 * @example
 * unique([{id:1,name:'A'}, {id:1,name:'B'}, {id:2,name:'C'}], 'id')
 * // ‚Üí [{id:1,name:'A'}, {id:2,name:'C'}]
 */
export function unique(array, key) {
  if (!Array.isArray(array)) return [];

  if (!key) {
    // So s√°nh to√†n b·ªô object (d√πng Set + JSON)
    const seen = new Set();
    return array.filter((item) => {
      const str = JSON.stringify(item);
      if (seen.has(str)) return false;
      seen.add(str);
      return true;
    });
  }

  const getKey = typeof key === "function" ? key : (item) => item?.[key];
  const seen = new Map();

  return array.filter((item) => {
    const k = getKey(item);
    if (seen.has(k)) return false;
    seen.set(k, true);
    return true;
  });
}

/**
 * S·∫Øp x·∫øp m·∫£ng theo nhi·ªÅu ti√™u ch√≠ (multi-key sort).
 * C√°c key ƒë∆∞·ª£c ∆∞u ti√™n t·ª´ tr√°i sang ph·∫£i.
 *
 * @template T
 * @param {T[]} array - M·∫£ng c·∫ßn s·∫Øp x·∫øp
 * @param {Array<
 *   string |                              // sort theo field ƒë∆°n gi·∫£n
 *   { key: string, order?: 'asc'|'desc' } // sort theo field + h∆∞·ªõng
 *   | ((a:T,b:T)=>number)                 // custom comparator
 * >} keys
 * @returns {T[]} M·∫£ng m·ªõi ƒë√£ ƒë∆∞·ª£c s·∫Øp x·∫øp (kh√¥ng mutate m·∫£ng g·ªëc)
 */
export function sortByMultiple(array, keys) {
  // Defensive: n·∫øu input kh√¥ng ph·∫£i array th√¨ tr·∫£ v·ªÅ m·∫£ng r·ªóng
  if (!Array.isArray(array)) return [];

  // Clone m·∫£ng tr∆∞·ªõc khi sort ƒë·ªÉ tr√°nh mutate d·ªØ li·ªáu g·ªëc
  return [...array].sort((a, b) => {
    // Duy·ªát t·ª´ng ti√™u ch√≠ theo th·ª© t·ª± ∆∞u ti√™n
    for (const criterion of keys) {
      // key: field d√πng ƒë·ªÉ sort
      // direction: 1 = asc, -1 = desc
      let key,
        direction = 1;

      /**
       * CASE 1: criterion l√† function
       * ‚Üí d√πng nh∆∞ comparator custom
       * ‚Üí gi·ªëng native Array.sort(compareFn)
       */
      if (typeof criterion === "function") {
        const result = criterion(a, b);

        // N·∫øu ƒë√£ ph√¢n th·∫Øng b·∫°i th√¨ return lu√¥n
        if (result !== 0) return result;

        // N·∫øu b·∫±ng nhau th√¨ x√©t ti√™u ch√≠ ti·∫øp theo
        continue;
      }

      /**
       * CASE 2: criterion l√† object { key, order }
       */
      if (typeof criterion === "object" && criterion !== null) {
        key = criterion.key;

        // N·∫øu order l√† 'desc' th√¨ ƒë·∫£o chi·ªÅu
        direction = criterion.order === "desc" ? -1 : 1;
      } else {
        /**
         * CASE 3: criterion l√† string
         * ‚Üí coi nh∆∞ key, m·∫∑c ƒë·ªãnh asc
         */
        key = criterion;
      }

      // L·∫•y gi√° tr·ªã c·∫ßn so s√°nh (optional chaining ƒë·ªÉ tr√°nh crash)
      const valA = a?.[key];
      const valB = b?.[key];

      // N·∫øu hai gi√° tr·ªã b·∫±ng nhau ‚Üí x√©t ti√™u ch√≠ ti·∫øp theo
      if (valA === valB) continue;

      /**
       * X·ª≠ l√Ω null / undefined:
       * - lu√¥n ƒë·∫©y null / undefined xu·ªëng cu·ªëi
       */
      if (valA == null) return 1;
      if (valB == null) return -1;

      /**
       * N·∫øu l√† string ‚Üí d√πng localeCompare
       * (an to√†n v·ªõi Unicode, ti·∫øng Vi·ªát, ƒëa ng√¥n ng·ªØ)
       */
      if (typeof valA === "string" && typeof valB === "string") {
        const cmp = valA.localeCompare(valB);

        // Nh√¢n v·ªõi direction ƒë·ªÉ x·ª≠ l√Ω asc / desc
        if (cmp !== 0) return cmp * direction;
      } else {
        /**
         * C√°c ki·ªÉu c√≤n l·∫°i: number, date, boolean
         */
        const cmp = valA < valB ? -1 : 1;

        // Nh√¢n direction ƒë·ªÉ ƒë·∫£o chi·ªÅu n·∫øu c·∫ßn
        if (cmp !== 0) return cmp * direction;
      }
    }

    // N·∫øu t·∫•t c·∫£ ti√™u ch√≠ ƒë·ªÅu b·∫±ng nhau
    return 0;
  });
}
```

</details>

## üìö T√ÄI LI·ªÜU THAM KH·∫¢O

### B·∫Øt bu·ªôc ƒë·ªçc

1. **MDN: Promises**
   - https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise
   - Focus: Promise basics, then, catch, finally

2. **MDN: async/await**
   - https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function
   - Focus: Syntax, error handling, common patterns

3. **MDN: ES6 Modules**
   - https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules
   - Focus: import/export syntax, best practices

4. **MDN: Optional Chaining**
   - https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Optional_chaining
   - Focus: Syntax variants, use cases

5. **MDN: Nullish Coalescing**
   - https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Nullish_coalescing
   - Focus: Difference from ||, when to use

### ƒê·ªçc th√™m

1. **JavaScript.info: Promises**
   - https://javascript.info/promise-basics
   - Excellent visual explanations

2. **ES6 Modules Deep Dive**
   - https://hacks.mozilla.org/2018/03/es-modules-a-cartoon-deep-dive/
   - How modules work under the hood

3. **Array Method Performance**
   - https://www.measurethat.net/
   - Benchmark different approaches

---

## üîó K·∫æT N·ªêI KI·∫æN TH·ª®C

### Ki·∫øn th·ª©c n·ªÅn (t·ª´ Ng√†y 1)

- **Destructuring** ‚Üí D√πng trong c√°c c√¢u l·ªánh import
- **Spread operator** ‚Üí D√πng trong c√°c ph√©p bi·∫øn ƒë·ªïi m·∫£ng
- **Arrow functions** ‚Üí D√πng l√†m callback cho array methods
- **Template literals** ‚Üí D√πng trong c√°c ti·ªán √≠ch x·ª≠ l√Ω chu·ªói

### H∆∞·ªõng t·ªõi (Ng√†y ti·∫øp theo)

**Ng√†y 3: React C∆° B·∫£n & JSX**

- S·∫Ω d√πng: ES6 modules ƒë·ªÉ import React
- S·∫Ω d√πng: Arrow functions ƒë·ªÉ vi·∫øt components
- S·∫Ω d√πng: Destructuring cho props
- S·∫Ω d√πng: Array methods ƒë·ªÉ render danh s√°ch

**Ng√†y 19: L·∫•y D·ªØ Li·ªáu (Data Fetching)**

- S·∫Ω **TH·ª∞C S·ª∞** s·ª≠ d·ª•ng: async/await
- S·∫Ω **TH·ª∞C S·ª∞** s·ª≠ d·ª•ng: Promise.all
- S·∫Ω d√πng: Optional chaining cho d·ªØ li·ªáu tr·∫£ v·ªÅ t·ª´ API

---

## üí° G√ìC NH√åN SENIOR

### C√¢n Nh·∫Øc Khi ƒê∆∞a V√†o Production

#### 1. **Async Patterns trong React**

```javascript
// ‚ö†Ô∏è H√îM NAY h·ªçc kh√°i ni·ªám, NG√ÄY 19 m·ªõi √°p d·ª•ng th·ª±c t·∫ø
// React components C·∫¶N nh·ªØng pattern ƒë·∫∑c bi·ªát cho async:
// - useEffect ƒë·ªÉ fetch d·ªØ li·ªáu
// - Loading states
// - Error boundaries
// Hi·ªán t·∫°i ch·ªâ c·∫ßn hi·ªÉu: async/await HO·∫†T ƒê·ªòNG nh∆∞ th·∫ø n√†o
```

#### 2. **ƒê√≥ng G√≥i Module (Module Bundling)**

```javascript
// Production build s·∫Ω bundle c√°c modules l·∫°i
// Tree-shaking s·∫Ω lo·∫°i b·ªè nh·ªØng export kh√¥ng d√πng
// Named exports ‚Üí Tree-shaking hi·ªáu qu·∫£ h∆°n
// Lu√¥n c√¢n nh·∫Øc ·∫£nh h∆∞·ªüng t·ªõi bundle size
```

#### 3. **C√¢n Nh·∫Øc Hi·ªáu NƒÉng**

```javascript
// Optional chaining c√≥ overhead r·∫•t nh·ªè
// Kh√¥ng ƒë√°ng k·ªÉ trong h·∫ßu h·∫øt tr∆∞·ªùng h·ª£p
// NH∆ØNG: Tr√°nh d√πng trong hot loops (h√†ng ngh√¨n l·∫ßn l·∫∑p)
// Lu√¥n profile tr∆∞·ªõc khi t·ªëi ∆∞u!
```

---

## üéØ C√ÇU H·ªéI PH·ªéNG V·∫§N

### Junior Level

```
Q: S·ª± kh√°c nhau gi·ªØa Promise v√† async/await?
A: async/await l√† c√∫ ph√°p sugar gi√∫p code Promise d·ªÖ ƒë·ªçc h∆°n.
   async function lu√¥n tr·∫£ v·ªÅ Promise.
   await t·∫°m d·ª´ng execution cho ƒë·∫øn khi Promise resolve.

Q: Khi n√†o d√πng ?? thay v√¨ ||?
A: D√πng ?? khi mu·ªën gi·ªØ l·∫°i c√°c falsy value h·ª£p l·ªá nh∆∞ 0, false, ''.
   || s·∫Ω thay th·∫ø T·∫§T C·∫¢ falsy values.

Q: find() v√† filter() kh√°c nhau th·∫ø n√†o?
A: find() tr·∫£ v·ªÅ ph·∫ßn t·ª≠ ƒë·∫ßu ti√™n tho·∫£ ƒëi·ªÅu ki·ªán v√† d·ª´ng s·ªõm.
   filter() tr·∫£ v·ªÅ t·∫•t c·∫£ ph·∫ßn t·ª≠ tho·∫£ ƒëi·ªÅu ki·ªán v√† duy·ªát to√†n b·ªô m·∫£ng.
```

### Mid Level

```
Q: Promise.all vs Promise.race vs Promise.allSettled?
A:
- Promise.all: Ch·ªù T·∫§T C·∫¢, ch·ªâ c·∫ßn 1 c√°i fail ‚Üí reject
- Promise.race: Tr·∫£ v·ªÅ promise settle ƒë·∫ßu ti√™n (resolve ho·∫∑c reject)
- Promise.allSettled: Ch·ªù T·∫§T C·∫¢, kh√¥ng bao gi·ªù reject

Q: L√†m sao t·ªëi ∆∞u hi·ªáu nƒÉng khi x·ª≠ l√Ω m·∫£ng l·ªõn?
A:
- D√πng ƒë√∫ng method (find thay v√¨ filter n·∫øu ch·ªâ c·∫ßn 1 ph·∫ßn t·ª≠)
- G·ªôp c√°c b∆∞·ªõc x·ª≠ l√Ω ƒë·ªÉ gi·∫£m s·ªë l·∫ßn l·∫∑p
- C√¢n nh·∫Øc lazy evaluation
- Lu√¥n ƒëo (profile) tr∆∞·ªõc khi t·ªëi ∆∞u

Q: Circular dependency trong modules, x·ª≠ l√Ω th·∫ø n√†o?
A:
- Refactor l·∫°i c·∫•u tr√∫c code ƒë·ªÉ tr√°nh
- T√°ch ph·∫ßn d√πng chung sang module ri√™ng
- D√πng dependency injection
- Xem l·∫°i thi·∫øt k·∫ø t·ªïng th·ªÉ, c√≥ th·ªÉ c·∫ßn refactor
```

### Senior Level

```
Q: Trade-off gi·ªØa c√°c module system (ESM vs CommonJS)?
A:

ESM:
- Ph√¢n t√≠ch tƒ©nh ‚Üí Tree-shaking t·ªët h∆°n
- H·ªó tr·ª£ load b·∫•t ƒë·ªìng b·ªô
- Native trong tr√¨nh duy·ªát
- H·ªó tr·ª£ top-level await

CommonJS:
- require() ƒë·ªông
- Load ƒë·ªìng b·ªô
- Truy·ªÅn th·ªëng trong Node.js
- Linh ho·∫°t h∆°n nh∆∞ng kh√≥ t·ªëi ∆∞u h∆°n

Q: Chi·∫øn l∆∞·ª£c x·ª≠ l√Ω l·ªói cho async trong production?
A:
- try/catch trong async functions
- Error boundaries trong React
- Global error handlers
- Logging / monitoring (Sentry)
- Graceful degradation
- Retry logic cho l·ªói t·∫°m th·ªùi
- Circuit breaker ƒë·ªÉ tr√°nh l·ªói d√¢y chuy·ªÅn

Q: Khi n√†o n√™n d√πng reduce() thay v√¨ map/filter chain?
A:

reduce():
- Duy·ªát m·∫£ng 1 l·∫ßn
- X·ª≠ l√Ω aggregation ph·ª©c t·∫°p
- T·∫°o nhi·ªÅu output
- NH∆ØNG: Kh√≥ ƒë·ªçc h∆°n

map/filter:
- √ù ƒë·ªãnh r√µ r√†ng
- D·ªÖ debug
- Duy·ªát nhi·ªÅu l·∫ßn (c√≥ th·ªÉ ch·∫≠m h∆°n)
- NH∆ØNG: D·ªÖ b·∫£o tr√¨ h∆°n

=> Code quan tr·ªçng hi·ªáu nƒÉng: ƒëo tr∆∞·ªõc
=> Code th√¥ng th∆∞·ªùng: ∆∞u ti√™n d·ªÖ ƒë·ªçc
```

---

## üß† WAR STORIES (KINH NGHI·ªÜM TH·ª∞C T·∫æ)

### Story 1: Bug V·ªõi Nullish Coalescing

```
V·∫•n ƒë·ªÅ: Website th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠ b·ªã l·ªói hi·ªÉn th·ªã
Root cause: const price = product.price || 'N/A';

Impact: S·∫£n ph·∫©m mi·ªÖn ph√≠ (price = 0)
        b·ªã hi·ªÉn th·ªã l√† 'N/A'

Fix: const price = product.price ?? 'N/A';

B√†i h·ªçc: LU√îN xem 0, false, '' c√≥ ph·∫£i l√† gi√° tr·ªã h·ª£p l·ªá kh√¥ng!
```

### Story 2: Th·∫£m Ho·∫° Promise.all

```
V·∫•n ƒë·ªÅ: Dashboard g·ªçi 10 API b·∫±ng Promise.all
Ch·ªâ c·∫ßn 1 API fail ‚Üí to√†n b·ªô dashboard tr·∫Øng xo√°

Fix:
- Chuy·ªÉn sang Promise.allSettled
- X·ª≠ l√Ω l·ªói t·ª´ng ph·∫ßn

B√†i h·ªçc: Promise.all l√† all-or-nothing.
         Lu√¥n c√¢n nh·∫Øc ƒë√∫ng use case!
```

### Story 3: Hi·ªáu NƒÉng Import Module

```
V·∫•n ƒë·ªÅ: Trang load l·∫ßn ƒë·∫ßu r·∫•t ch·∫≠m

Root cause:
import * as Utils from './utils'
‚Üí Import 50KB+ code kh√¥ng d√πng

Fix:
import { formatDate } from './utils'

Impact: Gi·∫£m bundle size ~40KB

B√†i h·ªçc: Tree-shaking hi·ªáu qu·∫£ nh·∫•t v·ªõi named imports!
```

---

## üéØ PREVIEW NG√ÄY MAI

**Ng√†y 3: React Basics & JSX**

B·∫°n s·∫Ω h·ªçc:

- ‚ú® T·∫°o React app ƒë·∫ßu ti√™n
- üé® JSX syntax v√† rules
- üîÑ JSX vs HTML differences
- üíª JavaScript expressions trong JSX

Chu·∫©n b·ªã:

- [ ] √în l·∫°i destructuring (s·∫Ω d√πng nhi·ªÅu!)
- [ ] √în l·∫°i arrow functions
- [ ] √în l·∫°i template literals
- [ ] Ho√†n th√†nh b√†i t·∫≠p v·ªÅ nh√†

H·∫πn g·∫∑p b·∫°n ng√†y mai! üöÄ

---

**üìä T·ªïng k·∫øt Ng√†y 2:**

- ‚úÖ ƒê√£ h·ªçc: Promises, async/await, ES6 Modules, ?., ??, Array methods n√¢ng cao
- ‚úÖ ƒê√£ th·ª±c h√†nh: 5 exercises t·ª´ basic ƒë·∫øn production
- ‚úÖ Debug: 3 common bugs
- üéØ S·∫µn s√†ng: B·∫Øt ƒë·∫ßu React journey!
